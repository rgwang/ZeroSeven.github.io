<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>python基础12(Pandas库) | rgwang</title><meta name="description" content="第十二章  Pandas库引子Numpy 在向量化的数值计算中表现优异 但是在处理更灵活、复杂的数据任务：  如为数据添加标签、处理缺失值、分组和透视表等方面   Numpy显得力不从心 而基于Numpy构建的Pandas库，提供了使得数据分析变得更快更简单的高级数据结构和操作工具 12.1 对象创建12.1.1 Pandas Series对象Series 是带标签数据的一维数组 Series对象"><meta name="keywords" content="python"><meta name="author" content="rgwang"><meta name="copyright" content="rgwang"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="python基础12(Pandas库)"><meta name="twitter:description" content="第十二章  Pandas库引子Numpy 在向量化的数值计算中表现优异 但是在处理更灵活、复杂的数据任务：  如为数据添加标签、处理缺失值、分组和透视表等方面   Numpy显得力不从心 而基于Numpy构建的Pandas库，提供了使得数据分析变得更快更简单的高级数据结构和操作工具 12.1 对象创建12.1.1 Pandas Series对象Series 是带标签数据的一维数组 Series对象"><meta name="twitter:image" content="https://rgwang.github.io/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg"><meta property="og:type" content="article"><meta property="og:title" content="python基础12(Pandas库)"><meta property="og:url" content="https://rgwang.github.io/2020/08/15/deepshare_python%E5%9F%BA%E7%A1%8012/"><meta property="og:site_name" content="rgwang"><meta property="og:description" content="第十二章  Pandas库引子Numpy 在向量化的数值计算中表现优异 但是在处理更灵活、复杂的数据任务：  如为数据添加标签、处理缺失值、分组和透视表等方面   Numpy显得力不从心 而基于Numpy构建的Pandas库，提供了使得数据分析变得更快更简单的高级数据结构和操作工具 12.1 对象创建12.1.1 Pandas Series对象Series 是带标签数据的一维数组 Series对象"><meta property="og:image" content="https://rgwang.github.io/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg"><meta property="article:published_time" content="2020-08-15T14:00:21.132Z"><meta property="article:modified_time" content="2020-08-17T05:03:16.418Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://rgwang.github.io/2020/08/15/deepshare_python%E5%9F%BA%E7%A1%8012/"><link rel="prev" title="python基础13(matplotlib库)" href="https://rgwang.github.io/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8013/"><link rel="next" title="python基础11(Numpy库)" href="https://rgwang.github.io/2020/08/15/deepshare_python%E5%9F%BA%E7%A1%8011/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://rgwang.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/1971a47ac42c3aad3425f91b89c64fd4.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">25</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">14</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第十二章-Pandas库"><span class="toc-number">1.</span> <span class="toc-text">第十二章  Pandas库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#引子"><span class="toc-number">1.1.</span> <span class="toc-text">引子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-1-对象创建"><span class="toc-number">1.2.</span> <span class="toc-text">12.1 对象创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-1-Pandas-Series对象"><span class="toc-number">1.2.1.</span> <span class="toc-text">12.1.1 Pandas Series对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-2-Pandas-DataFrame对象"><span class="toc-number">1.2.2.</span> <span class="toc-text">12.1.2 Pandas DataFrame对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-2-DataFrame性质"><span class="toc-number">1.3.</span> <span class="toc-text">12.2   DataFrame性质</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-3-数值运算及统计分析"><span class="toc-number">1.4.</span> <span class="toc-text">12.3 数值运算及统计分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-4-缺失值处理"><span class="toc-number">1.5.</span> <span class="toc-text">12.4 缺失值处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-5-合并数据"><span class="toc-number">1.6.</span> <span class="toc-text">12.5 合并数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-6-分组和数据透视表"><span class="toc-number">1.7.</span> <span class="toc-text">12.6 分组和数据透视表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-7-其他"><span class="toc-number">1.8.</span> <span class="toc-text">12.7 其他</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">rgwang</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">python基础12(Pandas库)</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-08-15 22:00:21"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-08-15</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-08-17 13:03:16"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-08-17</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Python/">Python</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">18.1k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 109 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="第十二章-Pandas库"><a href="#第十二章-Pandas库" class="headerlink" title="第十二章  Pandas库"></a>第十二章  Pandas库</h1><h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>Numpy 在向量化的数值计算中表现优异</p>
<p>但是在处理更灵活、复杂的数据任务： </p>
<p>如为数据添加标签、处理缺失值、分组和透视表等方面  </p>
<p>Numpy显得力不从心</p>
<p><strong>而基于Numpy构建的Pandas库，提供了使得数据分析变得更快更简单的高级数据结构和操作工具</strong></p>
<h2 id="12-1-对象创建"><a href="#12-1-对象创建" class="headerlink" title="12.1 对象创建"></a>12.1 对象创建</h2><h3 id="12-1-1-Pandas-Series对象"><a href="#12-1-1-Pandas-Series对象" class="headerlink" title="12.1.1 Pandas Series对象"></a>12.1.1 Pandas Series对象</h3><p>Series 是带标签数据的一维数组</p>
<p><strong>Series对象的创建</strong></p>
<p>通用结构: pd.Series(data, index=index, dtype=dtype)</p>
<p>data：数据，可以是列表，字典或Numpy数组</p>
<p>index：索引，为可选参数</p>
<p>dtype: 数据类型，为可选参数</p>
<p><strong>1、用列表创建</strong></p>
<ul>
<li>index缺省，默认为整数序列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = pd.Series([<span class="number">1.5</span>, <span class="number">3</span>, <span class="number">4.5</span>, <span class="number">6</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>0    1.5
1    3.0
2    4.5
3    6.0
dtype: float64
</code></pre><ul>
<li>增加index</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1.5</span>, <span class="number">3</span>, <span class="number">4.5</span>, <span class="number">6</span>], index=[<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>a    1.5
b    3.0
c    4.5
d    6.0
dtype: float64
</code></pre><ul>
<li><p>增加数据类型</p>
<pre><code>缺省则从传入的数据自动判断
</code></pre></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index=[<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>])    </span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>a    1
b    2
c    3
d    4
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index=[<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>], dtype=<span class="string">"float"</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>a    1.0
b    2.0
c    3.0
d    4.0
dtype: float64
</code></pre><p><strong>注意：数据支持多种类型</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="string">"3"</span>, <span class="number">4</span>], index=[<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>a    1
b    2
c    3
d    4
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">"a"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>1
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">"c"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>&#39;3&#39;
</code></pre><p><strong>数据类型可被强制改变</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="string">"3"</span>, <span class="number">4</span>], index=[<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>], dtype=float)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>a    1.0
b    2.0
c    3.0
d    4.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">"c"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>3.0
</code></pre><p><strong>2、用一维numpy数组创建</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">5</span>)</span><br><span class="line">pd.Series(x)</span><br></pre></td></tr></table></figure>
<pre><code>0    0
1    1
2    2
3    3
4    4
dtype: int32
</code></pre><p><strong>3、用字典创建</strong></p>
<ul>
<li>默认以键为index 值为data</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">"BeiJing"</span>: <span class="number">2154</span>,</span><br><span class="line">                   <span class="string">"ShangHai"</span>: <span class="number">2424</span>,</span><br><span class="line">                   <span class="string">"ShenZhen"</span>: <span class="number">1303</span>,</span><br><span class="line">                   <span class="string">"HangZhou"</span>: <span class="number">981</span> &#125;</span><br><span class="line">population = pd.Series(population_dict)    </span><br><span class="line">population</span><br></pre></td></tr></table></figure>
<pre><code>BeiJing     2154
ShangHai    2424
ShenZhen    1303
HangZhou     981
dtype: int64
</code></pre><ul>
<li>字典创建，如果指定index，则会到字典的键中筛选，找不到的，值设为NaN</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">population = pd.Series(population_dict, index=[<span class="string">"BeiJing"</span>, <span class="string">"HangZhou"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>])    </span><br><span class="line">population</span><br></pre></td></tr></table></figure>
<pre><code>BeiJing     2154.0
HangZhou     981.0
c              NaN
d              NaN
dtype: float64
</code></pre><p><strong>4、data为标量的情况</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(<span class="number">5</span>, index=[<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>])</span><br></pre></td></tr></table></figure>
<pre><code>100    5
200    5
300    5
dtype: int64
</code></pre><h3 id="12-1-2-Pandas-DataFrame对象"><a href="#12-1-2-Pandas-DataFrame对象" class="headerlink" title="12.1.2 Pandas DataFrame对象"></a>12.1.2 Pandas DataFrame对象</h3><p>DataFrame 是带标签数据的多维数组</p>
<p><strong>DataFrame对象的创建</strong></p>
<p>通用结构: pd.DataFrame(data, index=index, columns=columns)</p>
<p>data：数据，可以是列表，字典或Numpy数组</p>
<p>index：索引，为可选参数</p>
<p>columns: 列标签，为可选参数</p>
<p><strong>1、通过Series对象创建</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">"BeiJing"</span>: <span class="number">2154</span>,</span><br><span class="line">                   <span class="string">"ShangHai"</span>: <span class="number">2424</span>,</span><br><span class="line">                   <span class="string">"ShenZhen"</span>: <span class="number">1303</span>,</span><br><span class="line">                   <span class="string">"HangZhou"</span>: <span class="number">981</span> &#125;</span><br><span class="line"></span><br><span class="line">population = pd.Series(population_dict)    </span><br><span class="line">pd.DataFrame(population)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(population, columns=[<span class="string">"population"</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>2、通过Series对象字典创建</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GDP_dict = &#123;<span class="string">"BeiJing"</span>: <span class="number">30320</span>,</span><br><span class="line">            <span class="string">"ShangHai"</span>: <span class="number">32680</span>,</span><br><span class="line">            <span class="string">"ShenZhen"</span>: <span class="number">24222</span>,</span><br><span class="line">            <span class="string">"HangZhou"</span>: <span class="number">13468</span> &#125;</span><br><span class="line"></span><br><span class="line">GDP = pd.Series(GDP_dict)</span><br><span class="line">GDP</span><br></pre></td></tr></table></figure>
<pre><code>BeiJing     30320
ShangHai    32680
ShenZhen    24222
HangZhou    13468
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(&#123;<span class="string">"population"</span>: population,</span><br><span class="line">              <span class="string">"GDP"</span>: GDP&#125;)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>注意：数量不够的会自动补齐</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(&#123;<span class="string">"population"</span>: population,</span><br><span class="line">              <span class="string">"GDP"</span>: GDP,</span><br><span class="line">              <span class="string">"country"</span>: <span class="string">"China"</span>&#125;)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
      <td>China</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
      <td>China</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
      <td>China</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>3、通过字典列表对象创建</strong></p>
<ul>
<li>字典索引作为index，字典键作为columns</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = [&#123;<span class="string">"a"</span>: i, <span class="string">"b"</span>: <span class="number">2</span>*i&#125; <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>)]</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>[{&#39;a&#39;: 0, &#39;b&#39;: 0}, {&#39;a&#39;: 1, &#39;b&#39;: 2}, {&#39;a&#39;: 2, &#39;b&#39;: 4}]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(data)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data1 = data[<span class="string">"a"</span>].copy()</span><br><span class="line">data1</span><br></pre></td></tr></table></figure>
<pre><code>0    0
1    1
2    2
Name: a, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data1[<span class="number">0</span>] = <span class="number">10</span></span><br><span class="line">data1</span><br></pre></td></tr></table></figure>
<pre><code>0    10
1     1
2     2
Name: a, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>不存在的键，会默认值为NaN</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = [&#123;<span class="string">"a"</span>: <span class="number">1</span>, <span class="string">"b"</span>:<span class="number">1</span>&#125;,&#123;<span class="string">"b"</span>: <span class="number">3</span>, <span class="string">"c"</span>:<span class="number">4</span>&#125;]</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>[{&#39;a&#39;: 1, &#39;b&#39;: 1}, {&#39;b&#39;: 3, &#39;c&#39;: 4}]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(data)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>4、通过Numpy二维数组创建</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randint(<span class="number">10</span>, size=(<span class="number">3</span>, <span class="number">2</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<pre><code>array([[2, 8],
       [7, 7],
       [4, 1]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(data, columns=[<span class="string">"foo"</span>, <span class="string">"bar"</span>], index=[<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>b</th>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="12-2-DataFrame性质"><a href="#12-2-DataFrame性质" class="headerlink" title="12.2   DataFrame性质"></a>12.2   DataFrame性质</h2><p><strong>1、属性</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(&#123;<span class="string">"pop"</span>: population, <span class="string">"GDP"</span>: GDP&#125;)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（1）df.values  返回numpy数组表示的数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.values</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 2154, 30320],
       [ 2424, 32680],
       [ 1303, 24222],
       [  981, 13468]], dtype=int64)
</code></pre><p><strong>（2）df.index 返回行索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.index</span><br></pre></td></tr></table></figure>
<pre><code>Index([&#39;BeiJing&#39;, &#39;ShangHai&#39;, &#39;ShenZhen&#39;, &#39;HangZhou&#39;], dtype=&#39;object&#39;)
</code></pre><p><strong>（3）df.columns 返回列索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.columns</span><br></pre></td></tr></table></figure>
<pre><code>Index([&#39;pop&#39;, &#39;GDP&#39;], dtype=&#39;object&#39;)
</code></pre><p><strong>（4）df.shape  形状</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.shape</span><br></pre></td></tr></table></figure>
<pre><code>(4, 2)
</code></pre><p><strong>（5） pd.size 大小</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.size</span><br></pre></td></tr></table></figure>
<pre><code>8
</code></pre><p><strong>（6）pd.dtypes 返回每列数据类型</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dtypes</span><br></pre></td></tr></table></figure>
<pre><code>pop    int64
GDP    int64
dtype: object
</code></pre><p><strong>2、索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（1）获取列</strong></p>
<ul>
<li>字典式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">"pop"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>BeiJing     2154
ShangHai    2424
ShenZhen    1303
HangZhou     981
Name: pop, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[[<span class="string">"GDP"</span>, <span class="string">"pop"</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>30320</td>
      <td>2154</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>32680</td>
      <td>2424</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>24222</td>
      <td>1303</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>13468</td>
      <td>981</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>对象属性式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.GDP</span><br></pre></td></tr></table></figure>
<pre><code>BeiJing     30320
ShangHai    32680
ShenZhen    24222
HangZhou    13468
Name: GDP, dtype: int64
</code></pre><p><strong>（2）获取行</strong></p>
<ul>
<li>绝对索引 df.loc</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[<span class="string">"BeiJing"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>pop     2154
GDP    30320
Name: BeiJing, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[[<span class="string">"BeiJing"</span>, <span class="string">"HangZhou"</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>相对索引 df.iloc</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<pre><code>pop     2154
GDP    30320
Name: BeiJing, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[[<span class="number">1</span>, <span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（3）获取标量</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[<span class="string">"BeiJing"</span>, <span class="string">"GDP"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>30320
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>30320
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.values[<span class="number">0</span>][<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>30320
</code></pre><p><strong>（4）Series对象的索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(data.GDP)</span><br></pre></td></tr></table></figure>
<pre><code>pandas.core.series.Series
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GDP</span><br></pre></td></tr></table></figure>
<pre><code>BeiJing     30320
ShangHai    32680
ShenZhen    24222
HangZhou    13468
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GDP[<span class="string">"BeiJing"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>30320
</code></pre><p><strong>3、切片</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dates = pd.date_range(start=<span class="string">'2019-01-01'</span>, periods=<span class="number">6</span>)</span><br><span class="line">dates</span><br></pre></td></tr></table></figure>
<pre><code>DatetimeIndex([&#39;2019-01-01&#39;, &#39;2019-01-02&#39;, &#39;2019-01-03&#39;, &#39;2019-01-04&#39;,
               &#39;2019-01-05&#39;, &#39;2019-01-06&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>), index=dates, columns=[<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（1）行切片</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"2019-01-01"</span>: <span class="string">"2019-01-03"</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">"2019-01-01"</span>: <span class="string">"2019-01-03"</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>: <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（2）列切片</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">"A"</span>: <span class="string">"C"</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[:, <span class="number">0</span>: <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（3）多种多样的取值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>行、列同时切片</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">"2019-01-02"</span>: <span class="string">"2019-01-03"</span>, <span class="string">"C"</span>:<span class="string">"D"</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-02</th>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">1</span>: <span class="number">3</span>, <span class="number">2</span>:]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-02</th>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>行切片，列分散取值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">"2019-01-04"</span>: <span class="string">"2019-01-06"</span>, [<span class="string">"A"</span>, <span class="string">"C"</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>-0.206548</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>0.632606</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>-0.809467</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">3</span>:, [<span class="number">0</span>, <span class="number">2</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>-0.206548</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>0.632606</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>-0.809467</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>行分散取值，列切片</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[[<span class="number">1</span>, <span class="number">5</span>], <span class="number">0</span>: <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>行、列均分散取值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[[<span class="number">1</span>, <span class="number">5</span>], [<span class="number">0</span>, <span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>-0.167545</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>4、布尔索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df &gt; <span class="number">0</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df &gt; <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>NaN</td>
      <td>0.626769</td>
      <td>NaN</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>NaN</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>NaN</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>NaN</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.A &gt; <span class="number">0</span></span><br></pre></td></tr></table></figure>
<pre><code>2019-01-01    False
2019-01-02     True
2019-01-03    False
2019-01-04     True
2019-01-05    False
2019-01-06     True
Freq: D, Name: A, dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df.A &gt; <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>isin（）方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df2 = df.copy()</span><br><span class="line">df2[<span class="string">'E'</span>] = [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'three'</span>]</span><br><span class="line">df2</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
      <td>one</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
      <td>one</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
      <td>two</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
      <td>three</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
      <td>four</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
      <td>three</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ind = df2[<span class="string">"E"</span>].isin([<span class="string">"two"</span>, <span class="string">"four"</span>])</span><br><span class="line">ind</span><br></pre></td></tr></table></figure>
<pre><code>2019-01-01    False
2019-01-02    False
2019-01-03     True
2019-01-04    False
2019-01-05     True
2019-01-06    False
Freq: D, Name: E, dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2[ind]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
      <td>two</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
      <td>four</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（5）赋值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>DataFrame 增加新列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s1 = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], index=pd.date_range(<span class="string">'20190101'</span>, periods=<span class="number">6</span>))</span><br><span class="line">s1</span><br></pre></td></tr></table></figure>
<pre><code>2019-01-01    1
2019-01-02    2
2019-01-03    3
2019-01-04    4
2019-01-05    5
2019-01-06    6
Freq: D, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"E"</span>] = s1</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.216535</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>修改赋值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">"2019-01-01"</span>, <span class="string">"A"</span>] = <span class="number">0</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>0.000000</td>
      <td>0.626769</td>
      <td>-1.081884</td>
      <td>2.502263</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">0</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.081884</td>
      <td>2.502263</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>0.549048</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>1.728415</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>-1.239006</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>0.866231</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>-0.167545</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"D"</span>] = np.array([<span class="number">5</span>]*len(df))   <span class="comment"># 可简化成df["D"] = 5</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.081884</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>修改index和columns</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.index = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(len(df))]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.081884</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.columns = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(df.shape[<span class="number">1</span>])]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.081884</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.372347</td>
      <td>1.171852</td>
      <td>-2.133317</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.518353</td>
      <td>0.326511</td>
      <td>1.136111</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.026151</td>
      <td>0.417686</td>
      <td>-0.206548</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.400023</td>
      <td>1.556916</td>
      <td>0.632606</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.592977</td>
      <td>0.424912</td>
      <td>-0.809467</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="12-3-数值运算及统计分析"><a href="#12-3-数值运算及统计分析" class="headerlink" title="12.3 数值运算及统计分析"></a>12.3 数值运算及统计分析</h2><p><strong>1、数据的查看</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(start=<span class="string">'2019-01-01'</span>, periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>), index=dates, columns=[<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.307850</td>
      <td>0.173842</td>
      <td>0.289232</td>
      <td>-0.760544</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>-0.031179</td>
      <td>-0.347490</td>
      <td>-1.262502</td>
      <td>-0.275314</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>0.460746</td>
      <td>0.163705</td>
      <td>-2.589892</td>
      <td>0.361225</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>1.473358</td>
      <td>0.528740</td>
      <td>1.852892</td>
      <td>1.119610</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>0.149465</td>
      <td>0.960582</td>
      <td>-0.377960</td>
      <td>-0.144201</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>1.180568</td>
      <td>-0.823599</td>
      <td>0.424738</td>
      <td>0.485841</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（1）查看前面的行</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()    <span class="comment"># 默认5行</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.307850</td>
      <td>0.173842</td>
      <td>0.289232</td>
      <td>-0.760544</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>-0.031179</td>
      <td>-0.347490</td>
      <td>-1.262502</td>
      <td>-0.275314</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>0.460746</td>
      <td>0.163705</td>
      <td>-2.589892</td>
      <td>0.361225</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>1.473358</td>
      <td>0.528740</td>
      <td>1.852892</td>
      <td>1.119610</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>0.149465</td>
      <td>0.960582</td>
      <td>-0.377960</td>
      <td>-0.144201</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.307850</td>
      <td>0.173842</td>
      <td>0.289232</td>
      <td>-0.760544</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>-0.031179</td>
      <td>-0.347490</td>
      <td>-1.262502</td>
      <td>-0.275314</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（2）查看后面的行</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.tail()    <span class="comment"># 默认5行</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-02</th>
      <td>-0.031179</td>
      <td>-0.347490</td>
      <td>-1.262502</td>
      <td>-0.275314</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>0.460746</td>
      <td>0.163705</td>
      <td>-2.589892</td>
      <td>0.361225</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>1.473358</td>
      <td>0.528740</td>
      <td>1.852892</td>
      <td>1.119610</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>0.149465</td>
      <td>0.960582</td>
      <td>-0.377960</td>
      <td>-0.144201</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>1.180568</td>
      <td>-0.823599</td>
      <td>0.424738</td>
      <td>0.485841</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.tail(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-04</th>
      <td>1.473358</td>
      <td>0.528740</td>
      <td>1.852892</td>
      <td>1.119610</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>0.149465</td>
      <td>0.960582</td>
      <td>-0.377960</td>
      <td>-0.144201</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>1.180568</td>
      <td>-0.823599</td>
      <td>0.424738</td>
      <td>0.485841</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（3）查看总体信息</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>, <span class="number">3</span>] = np.nan</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>-0.307850</td>
      <td>0.173842</td>
      <td>0.289232</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>-0.031179</td>
      <td>-0.347490</td>
      <td>-1.262502</td>
      <td>-0.275314</td>
    </tr>
    <tr>
      <th>2019-01-03</th>
      <td>0.460746</td>
      <td>0.163705</td>
      <td>-2.589892</td>
      <td>0.361225</td>
    </tr>
    <tr>
      <th>2019-01-04</th>
      <td>1.473358</td>
      <td>0.528740</td>
      <td>1.852892</td>
      <td>1.119610</td>
    </tr>
    <tr>
      <th>2019-01-05</th>
      <td>0.149465</td>
      <td>0.960582</td>
      <td>-0.377960</td>
      <td>-0.144201</td>
    </tr>
    <tr>
      <th>2019-01-06</th>
      <td>1.180568</td>
      <td>-0.823599</td>
      <td>0.424738</td>
      <td>0.485841</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 6 entries, 2019-01-01 to 2019-01-06
Freq: D
Data columns (total 4 columns):
A    6 non-null float64
B    6 non-null float64
C    6 non-null float64
D    5 non-null float64
dtypes: float64(4)
memory usage: 240.0 bytes
</code></pre><p><strong>2、Numpy通用函数同样适用于Pandas</strong></p>
<p><strong>（1）向量化运算</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = pd.DataFrame(np.arange(<span class="number">4</span>).reshape(<span class="number">1</span>, <span class="number">4</span>))</span><br><span class="line">x</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x+<span class="number">5</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.exp(x)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.718282</td>
      <td>7.389056</td>
      <td>20.085537</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = pd.DataFrame(np.arange(<span class="number">4</span>,<span class="number">8</span>).reshape(<span class="number">1</span>, <span class="number">4</span>))</span><br><span class="line">y</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x*y</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>5</td>
      <td>12</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（2）矩阵化运算</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">x = pd.DataFrame(np.random.randint(<span class="number">10</span>, size=(<span class="number">30</span>, <span class="number">30</span>)))</span><br><span class="line">x</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>7</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>5</td>
      <td>8</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>8</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>9</td>
      <td>3</td>
      <td>7</td>
      <td>6</td>
      <td>8</td>
      <td>...</td>
      <td>6</td>
      <td>8</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>8</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>9</td>
      <td>6</td>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>6</td>
      <td>...</td>
      <td>9</td>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>6</td>
      <td>5</td>
      <td>7</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>9</td>
      <td>7</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>5</td>
      <td>6</td>
      <td>...</td>
      <td>5</td>
      <td>0</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>3</td>
      <td>6</td>
      <td>3</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
      <td>1</td>
      <td>7</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
      <td>7</td>
      <td>7</td>
      <td>6</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
      <td>...</td>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>1</td>
      <td>8</td>
      <td>7</td>
      <td>9</td>
      <td>...</td>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>9</td>
      <td>9</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3</td>
      <td>9</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>...</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>4</td>
      <td>9</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13</th>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>7</td>
      <td>...</td>
      <td>5</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>6</td>
      <td>3</td>
      <td>9</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>8</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>16</th>
      <td>3</td>
      <td>9</td>
      <td>4</td>
      <td>8</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2</td>
      <td>8</td>
      <td>6</td>
      <td>3</td>
      <td>2</td>
      <td>9</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>8</td>
      <td>...</td>
      <td>6</td>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>9</td>
      <td>8</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>9</td>
      <td>3</td>
      <td>7</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>2</td>
      <td>6</td>
      <td>8</td>
      <td>9</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>...</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>1</td>
      <td>9</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>22</th>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>8</td>
      <td>0</td>
      <td>6</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>5</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>9</td>
      <td>7</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>1</td>
      <td>5</td>
      <td>...</td>
      <td>3</td>
      <td>7</td>
      <td>8</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>9</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>25</th>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>9</td>
      <td>...</td>
      <td>9</td>
      <td>3</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>26</th>
      <td>6</td>
      <td>7</td>
      <td>1</td>
      <td>9</td>
      <td>7</td>
      <td>2</td>
      <td>6</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>5</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>3</td>
      <td>9</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2</td>
      <td>8</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>28</th>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>9</td>
      <td>2</td>
      <td>4</td>
      <td>5</td>
      <td>9</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>29</th>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 30 columns</p>
</div>



<ul>
<li>转置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">z = x.T</span><br><span class="line">z</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>8</td>
      <td>3</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>4</td>
      <td>6</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>6</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>...</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>7</td>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>3</td>
      <td>7</td>
      <td>...</td>
      <td>5</td>
      <td>8</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2</td>
      <td>9</td>
      <td>9</td>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>6</td>
      <td>...</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>6</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>...</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>...</td>
      <td>8</td>
      <td>7</td>
      <td>4</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>8</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>9</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>9</td>
      <td>6</td>
      <td>7</td>
      <td>2</td>
      <td>...</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7</td>
      <td>1</td>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>9</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>5</td>
      <td>6</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>...</td>
      <td>7</td>
      <td>7</td>
      <td>9</td>
      <td>2</td>
      <td>5</td>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>7</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>12</th>
      <td>7</td>
      <td>9</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>5</td>
      <td>5</td>
      <td>...</td>
      <td>9</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2</td>
      <td>8</td>
      <td>4</td>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>2</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>8</td>
      <td>5</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>5</td>
      <td>9</td>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>6</td>
      <td>9</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4</td>
      <td>4</td>
      <td>9</td>
      <td>4</td>
      <td>9</td>
      <td>0</td>
      <td>7</td>
      <td>9</td>
      <td>2</td>
      <td>7</td>
      <td>...</td>
      <td>7</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>9</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>8</td>
      <td>1</td>
      <td>...</td>
      <td>9</td>
      <td>9</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>17</th>
      <td>7</td>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>...</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>5</td>
      <td>9</td>
      <td>7</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>18</th>
      <td>5</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
      <td>7</td>
      <td>0</td>
      <td>8</td>
      <td>4</td>
      <td>8</td>
      <td>7</td>
    </tr>
    <tr>
      <th>20</th>
      <td>4</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>3</td>
      <td>9</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>5</td>
      <td>1</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>3</td>
      <td>6</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>22</th>
      <td>9</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>8</td>
      <td>4</td>
      <td>8</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>2</td>
      <td>9</td>
      <td>7</td>
      <td>2</td>
      <td>7</td>
      <td>9</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>8</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>6</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>4</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>0</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>2</td>
      <td>9</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>8</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>...</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>8</td>
      <td>6</td>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>28</th>
      <td>6</td>
      <td>5</td>
      <td>7</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>9</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>...</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>29</th>
      <td>3</td>
      <td>9</td>
      <td>2</td>
      <td>8</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>...</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>9</td>
      <td>9</td>
      <td>7</td>
      <td>2</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 30 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">y = pd.DataFrame(np.random.randint(<span class="number">10</span>, size=(<span class="number">30</span>, <span class="number">30</span>)))</span><br><span class="line">y</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>6</td>
      <td>9</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>9</td>
      <td>9</td>
      <td>7</td>
      <td>6</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>3</td>
      <td>9</td>
      <td>8</td>
      <td>7</td>
      <td>3</td>
      <td>6</td>
      <td>...</td>
      <td>9</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>9</td>
      <td>2</td>
      <td>7</td>
      <td>7</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>9</td>
      <td>3</td>
      <td>7</td>
      <td>7</td>
      <td>4</td>
      <td>5</td>
      <td>9</td>
      <td>3</td>
      <td>6</td>
      <td>...</td>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>8</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>2</td>
      <td>5</td>
      <td>7</td>
      <td>8</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>7</td>
      <td>4</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>9</td>
      <td>8</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
      <td>6</td>
      <td>2</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9</td>
      <td>3</td>
      <td>9</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>8</td>
      <td>8</td>
      <td>9</td>
      <td>...</td>
      <td>1</td>
      <td>8</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>8</td>
      <td>...</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>7</td>
      <td>3</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>9</td>
      <td>6</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>6</td>
      <td>7</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>9</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
      <td>2</td>
      <td>...</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>6</td>
      <td>4</td>
      <td>7</td>
      <td>6</td>
      <td>2</td>
      <td>9</td>
      <td>5</td>
      <td>9</td>
      <td>9</td>
      <td>...</td>
      <td>4</td>
      <td>9</td>
      <td>3</td>
      <td>9</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2</td>
      <td>3</td>
      <td>9</td>
      <td>9</td>
      <td>4</td>
      <td>4</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>...</td>
      <td>0</td>
      <td>5</td>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>6</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>...</td>
      <td>8</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>13</th>
      <td>5</td>
      <td>1</td>
      <td>5</td>
      <td>9</td>
      <td>6</td>
      <td>4</td>
      <td>9</td>
      <td>8</td>
      <td>7</td>
      <td>5</td>
      <td>...</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>3</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>5</td>
      <td>5</td>
      <td>7</td>
      <td>5</td>
      <td>9</td>
      <td>1</td>
      <td>3</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>2</td>
      <td>...</td>
      <td>7</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>3</td>
      <td>8</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>6</td>
      <td>5</td>
      <td>9</td>
      <td>6</td>
      <td>4</td>
      <td>6</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>3</td>
      <td>6</td>
      <td>8</td>
      <td>6</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>6</td>
      <td>7</td>
      <td>2</td>
      <td>8</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>5</td>
      <td>6</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>9</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>8</td>
      <td>7</td>
      <td>7</td>
      <td>6</td>
      <td>1</td>
      <td>...</td>
      <td>7</td>
      <td>9</td>
      <td>9</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>8</td>
      <td>5</td>
      <td>9</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>3</td>
      <td>9</td>
      <td>9</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>6</td>
      <td>...</td>
      <td>2</td>
      <td>9</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>9</td>
      <td>4</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2</td>
      <td>8</td>
      <td>6</td>
      <td>4</td>
      <td>9</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>...</td>
      <td>6</td>
      <td>7</td>
      <td>5</td>
      <td>6</td>
      <td>8</td>
      <td>7</td>
      <td>4</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>6</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>9</td>
      <td>3</td>
      <td>9</td>
      <td>5</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>23</th>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>8</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>1</td>
      <td>9</td>
      <td>6</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>24</th>
      <td>6</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>5</td>
      <td>2</td>
      <td>9</td>
      <td>4</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>25</th>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
      <td>3</td>
      <td>...</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>5</td>
      <td>9</td>
      <td>2</td>
      <td>7</td>
      <td>4</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>26</th>
      <td>9</td>
      <td>8</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>8</td>
      <td>...</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1</td>
      <td>8</td>
      <td>6</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>2</td>
      <td>...</td>
      <td>9</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>...</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>7</td>
      <td>3</td>
      <td>9</td>
      <td>2</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>29</th>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>8</td>
      <td>3</td>
      <td>6</td>
      <td>4</td>
      <td>9</td>
      <td>7</td>
      <td>...</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>5</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 30 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x.dot(y)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>616</td>
      <td>560</td>
      <td>723</td>
      <td>739</td>
      <td>612</td>
      <td>457</td>
      <td>681</td>
      <td>799</td>
      <td>575</td>
      <td>590</td>
      <td>...</td>
      <td>523</td>
      <td>739</td>
      <td>613</td>
      <td>580</td>
      <td>668</td>
      <td>602</td>
      <td>733</td>
      <td>585</td>
      <td>657</td>
      <td>700</td>
    </tr>
    <tr>
      <th>1</th>
      <td>520</td>
      <td>438</td>
      <td>691</td>
      <td>600</td>
      <td>612</td>
      <td>455</td>
      <td>666</td>
      <td>764</td>
      <td>707</td>
      <td>592</td>
      <td>...</td>
      <td>555</td>
      <td>681</td>
      <td>503</td>
      <td>679</td>
      <td>641</td>
      <td>506</td>
      <td>779</td>
      <td>494</td>
      <td>633</td>
      <td>590</td>
    </tr>
    <tr>
      <th>2</th>
      <td>557</td>
      <td>570</td>
      <td>786</td>
      <td>807</td>
      <td>690</td>
      <td>469</td>
      <td>804</td>
      <td>828</td>
      <td>704</td>
      <td>573</td>
      <td>...</td>
      <td>563</td>
      <td>675</td>
      <td>712</td>
      <td>758</td>
      <td>793</td>
      <td>672</td>
      <td>754</td>
      <td>550</td>
      <td>756</td>
      <td>638</td>
    </tr>
    <tr>
      <th>3</th>
      <td>605</td>
      <td>507</td>
      <td>664</td>
      <td>701</td>
      <td>660</td>
      <td>496</td>
      <td>698</td>
      <td>806</td>
      <td>651</td>
      <td>575</td>
      <td>...</td>
      <td>582</td>
      <td>685</td>
      <td>668</td>
      <td>586</td>
      <td>629</td>
      <td>534</td>
      <td>678</td>
      <td>484</td>
      <td>591</td>
      <td>626</td>
    </tr>
    <tr>
      <th>4</th>
      <td>599</td>
      <td>681</td>
      <td>753</td>
      <td>873</td>
      <td>721</td>
      <td>563</td>
      <td>754</td>
      <td>770</td>
      <td>620</td>
      <td>654</td>
      <td>...</td>
      <td>633</td>
      <td>747</td>
      <td>661</td>
      <td>677</td>
      <td>726</td>
      <td>649</td>
      <td>716</td>
      <td>610</td>
      <td>735</td>
      <td>706</td>
    </tr>
    <tr>
      <th>5</th>
      <td>422</td>
      <td>354</td>
      <td>602</td>
      <td>627</td>
      <td>613</td>
      <td>396</td>
      <td>617</td>
      <td>627</td>
      <td>489</td>
      <td>423</td>
      <td>...</td>
      <td>456</td>
      <td>572</td>
      <td>559</td>
      <td>537</td>
      <td>499</td>
      <td>384</td>
      <td>589</td>
      <td>436</td>
      <td>574</td>
      <td>507</td>
    </tr>
    <tr>
      <th>6</th>
      <td>359</td>
      <td>446</td>
      <td>599</td>
      <td>599</td>
      <td>481</td>
      <td>357</td>
      <td>577</td>
      <td>572</td>
      <td>451</td>
      <td>464</td>
      <td>...</td>
      <td>449</td>
      <td>550</td>
      <td>495</td>
      <td>532</td>
      <td>633</td>
      <td>554</td>
      <td>663</td>
      <td>476</td>
      <td>565</td>
      <td>602</td>
    </tr>
    <tr>
      <th>7</th>
      <td>531</td>
      <td>520</td>
      <td>698</td>
      <td>590</td>
      <td>607</td>
      <td>537</td>
      <td>665</td>
      <td>696</td>
      <td>571</td>
      <td>472</td>
      <td>...</td>
      <td>576</td>
      <td>588</td>
      <td>551</td>
      <td>665</td>
      <td>652</td>
      <td>527</td>
      <td>742</td>
      <td>528</td>
      <td>650</td>
      <td>599</td>
    </tr>
    <tr>
      <th>8</th>
      <td>449</td>
      <td>322</td>
      <td>547</td>
      <td>533</td>
      <td>593</td>
      <td>399</td>
      <td>584</td>
      <td>638</td>
      <td>587</td>
      <td>424</td>
      <td>...</td>
      <td>402</td>
      <td>596</td>
      <td>523</td>
      <td>523</td>
      <td>447</td>
      <td>362</td>
      <td>561</td>
      <td>386</td>
      <td>529</td>
      <td>484</td>
    </tr>
    <tr>
      <th>9</th>
      <td>373</td>
      <td>433</td>
      <td>525</td>
      <td>601</td>
      <td>522</td>
      <td>345</td>
      <td>551</td>
      <td>521</td>
      <td>434</td>
      <td>447</td>
      <td>...</td>
      <td>508</td>
      <td>498</td>
      <td>438</td>
      <td>478</td>
      <td>459</td>
      <td>418</td>
      <td>488</td>
      <td>407</td>
      <td>503</td>
      <td>496</td>
    </tr>
    <tr>
      <th>10</th>
      <td>500</td>
      <td>427</td>
      <td>574</td>
      <td>607</td>
      <td>667</td>
      <td>477</td>
      <td>652</td>
      <td>656</td>
      <td>615</td>
      <td>477</td>
      <td>...</td>
      <td>622</td>
      <td>702</td>
      <td>531</td>
      <td>610</td>
      <td>558</td>
      <td>532</td>
      <td>598</td>
      <td>471</td>
      <td>582</td>
      <td>561</td>
    </tr>
    <tr>
      <th>11</th>
      <td>664</td>
      <td>694</td>
      <td>772</td>
      <td>841</td>
      <td>779</td>
      <td>574</td>
      <td>730</td>
      <td>810</td>
      <td>711</td>
      <td>608</td>
      <td>...</td>
      <td>591</td>
      <td>760</td>
      <td>616</td>
      <td>638</td>
      <td>721</td>
      <td>676</td>
      <td>846</td>
      <td>678</td>
      <td>754</td>
      <td>708</td>
    </tr>
    <tr>
      <th>12</th>
      <td>545</td>
      <td>547</td>
      <td>687</td>
      <td>701</td>
      <td>721</td>
      <td>576</td>
      <td>689</td>
      <td>724</td>
      <td>710</td>
      <td>532</td>
      <td>...</td>
      <td>674</td>
      <td>684</td>
      <td>648</td>
      <td>694</td>
      <td>710</td>
      <td>564</td>
      <td>757</td>
      <td>571</td>
      <td>671</td>
      <td>656</td>
    </tr>
    <tr>
      <th>13</th>
      <td>574</td>
      <td>586</td>
      <td>723</td>
      <td>750</td>
      <td>691</td>
      <td>494</td>
      <td>696</td>
      <td>787</td>
      <td>667</td>
      <td>523</td>
      <td>...</td>
      <td>618</td>
      <td>681</td>
      <td>568</td>
      <td>682</td>
      <td>715</td>
      <td>644</td>
      <td>756</td>
      <td>557</td>
      <td>690</td>
      <td>604</td>
    </tr>
    <tr>
      <th>14</th>
      <td>502</td>
      <td>382</td>
      <td>645</td>
      <td>557</td>
      <td>570</td>
      <td>403</td>
      <td>538</td>
      <td>677</td>
      <td>500</td>
      <td>501</td>
      <td>...</td>
      <td>369</td>
      <td>650</td>
      <td>507</td>
      <td>576</td>
      <td>546</td>
      <td>531</td>
      <td>554</td>
      <td>437</td>
      <td>616</td>
      <td>463</td>
    </tr>
    <tr>
      <th>15</th>
      <td>510</td>
      <td>505</td>
      <td>736</td>
      <td>651</td>
      <td>649</td>
      <td>510</td>
      <td>719</td>
      <td>733</td>
      <td>694</td>
      <td>557</td>
      <td>...</td>
      <td>605</td>
      <td>717</td>
      <td>574</td>
      <td>642</td>
      <td>678</td>
      <td>576</td>
      <td>755</td>
      <td>455</td>
      <td>598</td>
      <td>654</td>
    </tr>
    <tr>
      <th>16</th>
      <td>567</td>
      <td>376</td>
      <td>614</td>
      <td>612</td>
      <td>643</td>
      <td>514</td>
      <td>598</td>
      <td>724</td>
      <td>547</td>
      <td>464</td>
      <td>...</td>
      <td>456</td>
      <td>639</td>
      <td>520</td>
      <td>560</td>
      <td>569</td>
      <td>442</td>
      <td>596</td>
      <td>517</td>
      <td>659</td>
      <td>532</td>
    </tr>
    <tr>
      <th>17</th>
      <td>626</td>
      <td>716</td>
      <td>828</td>
      <td>765</td>
      <td>740</td>
      <td>603</td>
      <td>809</td>
      <td>852</td>
      <td>692</td>
      <td>591</td>
      <td>...</td>
      <td>664</td>
      <td>716</td>
      <td>655</td>
      <td>721</td>
      <td>742</td>
      <td>612</td>
      <td>819</td>
      <td>593</td>
      <td>744</td>
      <td>712</td>
    </tr>
    <tr>
      <th>18</th>
      <td>600</td>
      <td>559</td>
      <td>667</td>
      <td>664</td>
      <td>641</td>
      <td>556</td>
      <td>624</td>
      <td>815</td>
      <td>638</td>
      <td>564</td>
      <td>...</td>
      <td>581</td>
      <td>701</td>
      <td>559</td>
      <td>677</td>
      <td>710</td>
      <td>554</td>
      <td>748</td>
      <td>597</td>
      <td>614</td>
      <td>657</td>
    </tr>
    <tr>
      <th>19</th>
      <td>445</td>
      <td>431</td>
      <td>661</td>
      <td>681</td>
      <td>641</td>
      <td>552</td>
      <td>690</td>
      <td>719</td>
      <td>602</td>
      <td>474</td>
      <td>...</td>
      <td>515</td>
      <td>637</td>
      <td>576</td>
      <td>620</td>
      <td>572</td>
      <td>512</td>
      <td>599</td>
      <td>455</td>
      <td>622</td>
      <td>538</td>
    </tr>
    <tr>
      <th>20</th>
      <td>523</td>
      <td>569</td>
      <td>784</td>
      <td>725</td>
      <td>713</td>
      <td>501</td>
      <td>740</td>
      <td>772</td>
      <td>638</td>
      <td>640</td>
      <td>...</td>
      <td>589</td>
      <td>775</td>
      <td>664</td>
      <td>686</td>
      <td>726</td>
      <td>672</td>
      <td>747</td>
      <td>548</td>
      <td>723</td>
      <td>645</td>
    </tr>
    <tr>
      <th>21</th>
      <td>487</td>
      <td>465</td>
      <td>553</td>
      <td>639</td>
      <td>517</td>
      <td>449</td>
      <td>592</td>
      <td>609</td>
      <td>454</td>
      <td>398</td>
      <td>...</td>
      <td>492</td>
      <td>567</td>
      <td>534</td>
      <td>404</td>
      <td>554</td>
      <td>417</td>
      <td>561</td>
      <td>466</td>
      <td>498</td>
      <td>492</td>
    </tr>
    <tr>
      <th>22</th>
      <td>479</td>
      <td>449</td>
      <td>574</td>
      <td>686</td>
      <td>583</td>
      <td>377</td>
      <td>566</td>
      <td>614</td>
      <td>563</td>
      <td>455</td>
      <td>...</td>
      <td>453</td>
      <td>539</td>
      <td>491</td>
      <td>501</td>
      <td>596</td>
      <td>520</td>
      <td>722</td>
      <td>478</td>
      <td>565</td>
      <td>501</td>
    </tr>
    <tr>
      <th>23</th>
      <td>483</td>
      <td>386</td>
      <td>476</td>
      <td>526</td>
      <td>550</td>
      <td>426</td>
      <td>492</td>
      <td>585</td>
      <td>536</td>
      <td>482</td>
      <td>...</td>
      <td>322</td>
      <td>541</td>
      <td>438</td>
      <td>456</td>
      <td>487</td>
      <td>408</td>
      <td>502</td>
      <td>426</td>
      <td>474</td>
      <td>481</td>
    </tr>
    <tr>
      <th>24</th>
      <td>523</td>
      <td>551</td>
      <td>658</td>
      <td>767</td>
      <td>537</td>
      <td>444</td>
      <td>663</td>
      <td>731</td>
      <td>576</td>
      <td>577</td>
      <td>...</td>
      <td>522</td>
      <td>590</td>
      <td>525</td>
      <td>664</td>
      <td>691</td>
      <td>548</td>
      <td>635</td>
      <td>526</td>
      <td>641</td>
      <td>538</td>
    </tr>
    <tr>
      <th>25</th>
      <td>652</td>
      <td>656</td>
      <td>738</td>
      <td>753</td>
      <td>853</td>
      <td>508</td>
      <td>752</td>
      <td>815</td>
      <td>669</td>
      <td>576</td>
      <td>...</td>
      <td>694</td>
      <td>833</td>
      <td>693</td>
      <td>606</td>
      <td>575</td>
      <td>616</td>
      <td>704</td>
      <td>559</td>
      <td>728</td>
      <td>672</td>
    </tr>
    <tr>
      <th>26</th>
      <td>578</td>
      <td>577</td>
      <td>744</td>
      <td>856</td>
      <td>699</td>
      <td>497</td>
      <td>779</td>
      <td>800</td>
      <td>733</td>
      <td>587</td>
      <td>...</td>
      <td>630</td>
      <td>754</td>
      <td>704</td>
      <td>834</td>
      <td>760</td>
      <td>680</td>
      <td>765</td>
      <td>592</td>
      <td>731</td>
      <td>629</td>
    </tr>
    <tr>
      <th>27</th>
      <td>554</td>
      <td>494</td>
      <td>665</td>
      <td>689</td>
      <td>630</td>
      <td>574</td>
      <td>695</td>
      <td>703</td>
      <td>636</td>
      <td>599</td>
      <td>...</td>
      <td>554</td>
      <td>685</td>
      <td>532</td>
      <td>658</td>
      <td>649</td>
      <td>554</td>
      <td>693</td>
      <td>577</td>
      <td>634</td>
      <td>668</td>
    </tr>
    <tr>
      <th>28</th>
      <td>498</td>
      <td>552</td>
      <td>659</td>
      <td>784</td>
      <td>552</td>
      <td>492</td>
      <td>690</td>
      <td>775</td>
      <td>544</td>
      <td>551</td>
      <td>...</td>
      <td>567</td>
      <td>636</td>
      <td>518</td>
      <td>599</td>
      <td>742</td>
      <td>521</td>
      <td>733</td>
      <td>533</td>
      <td>605</td>
      <td>604</td>
    </tr>
    <tr>
      <th>29</th>
      <td>513</td>
      <td>491</td>
      <td>563</td>
      <td>642</td>
      <td>477</td>
      <td>367</td>
      <td>589</td>
      <td>647</td>
      <td>516</td>
      <td>484</td>
      <td>...</td>
      <td>428</td>
      <td>574</td>
      <td>504</td>
      <td>548</td>
      <td>553</td>
      <td>483</td>
      <td>540</td>
      <td>407</td>
      <td>547</td>
      <td>455</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 30 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit x.dot(y)</span><br></pre></td></tr></table></figure>
<pre><code>184 µs ± 7.03 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit np.dot(x, y)</span><br></pre></td></tr></table></figure>
<pre><code>66.4 µs ± 2.46 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</code></pre><ul>
<li>执行相同运算，Numpy与Pandas的对比</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x1 = np.array(x)</span><br><span class="line">x1</span><br></pre></td></tr></table></figure>
<pre><code>array([[6, 3, 7, 4, 6, 9, 2, 6, 7, 4, 3, 7, 7, 2, 5, 4, 1, 7, 5, 1, 4, 0,
        9, 5, 8, 0, 9, 2, 6, 3],
       [8, 2, 4, 2, 6, 4, 8, 6, 1, 3, 8, 1, 9, 8, 9, 4, 1, 3, 6, 7, 2, 0,
        3, 1, 7, 3, 1, 5, 5, 9],
       [3, 5, 1, 9, 1, 9, 3, 7, 6, 8, 7, 4, 1, 4, 7, 9, 8, 8, 0, 8, 6, 8,
        7, 0, 7, 7, 2, 0, 7, 2],
       [2, 0, 4, 9, 6, 9, 8, 6, 8, 7, 1, 0, 6, 6, 7, 4, 2, 7, 5, 2, 0, 2,
        4, 2, 0, 4, 9, 6, 6, 8],
       [9, 9, 2, 6, 0, 3, 3, 4, 6, 6, 3, 6, 2, 5, 1, 9, 8, 4, 5, 3, 9, 6,
        8, 6, 0, 0, 8, 8, 3, 8],
       [2, 6, 5, 7, 8, 4, 0, 2, 9, 7, 5, 7, 8, 3, 0, 0, 9, 3, 6, 1, 2, 0,
        4, 0, 7, 0, 0, 1, 1, 5],
       [6, 4, 0, 0, 2, 1, 4, 9, 5, 6, 3, 6, 7, 0, 5, 7, 4, 3, 1, 5, 5, 0,
        8, 5, 2, 3, 3, 2, 9, 2],
       [2, 3, 6, 3, 8, 0, 7, 6, 1, 7, 0, 8, 8, 1, 6, 9, 2, 6, 9, 8, 3, 0,
        1, 0, 4, 4, 6, 8, 8, 2],
       [2, 2, 3, 7, 5, 7, 0, 7, 3, 0, 7, 3, 5, 7, 3, 2, 8, 2, 8, 1, 1, 1,
        5, 2, 8, 3, 0, 3, 0, 4],
       [3, 7, 7, 6, 2, 0, 0, 2, 5, 6, 5, 5, 5, 2, 5, 7, 1, 4, 0, 0, 4, 2,
        3, 2, 0, 0, 4, 5, 2, 8],
       [4, 7, 0, 4, 2, 0, 3, 4, 6, 0, 2, 1, 8, 9, 5, 9, 2, 7, 7, 1, 5, 6,
        1, 9, 1, 9, 0, 7, 0, 8],
       [5, 6, 9, 6, 9, 2, 1, 8, 7, 9, 6, 8, 3, 3, 0, 7, 2, 6, 1, 1, 6, 5,
        2, 8, 9, 5, 9, 9, 5, 0],
       [3, 9, 5, 5, 4, 0, 7, 4, 4, 6, 3, 5, 3, 2, 6, 7, 3, 1, 9, 2, 0, 7,
        2, 9, 6, 9, 4, 9, 4, 6],
       [8, 4, 0, 9, 9, 0, 1, 5, 8, 7, 4, 0, 6, 4, 5, 6, 2, 9, 2, 4, 5, 8,
        4, 0, 3, 4, 9, 9, 4, 6],
       [3, 0, 4, 6, 9, 9, 5, 4, 3, 1, 3, 9, 9, 2, 9, 0, 7, 4, 3, 7, 6, 1,
        0, 3, 7, 1, 2, 0, 0, 2],
       [4, 2, 0, 0, 7, 9, 1, 2, 1, 2, 6, 0, 9, 7, 9, 9, 9, 1, 2, 8, 6, 3,
        9, 4, 1, 7, 3, 8, 4, 8],
       [3, 9, 4, 8, 7, 2, 0, 2, 3, 1, 0, 6, 7, 6, 4, 0, 6, 6, 8, 2, 8, 0,
        0, 3, 8, 5, 2, 0, 3, 8],
       [2, 8, 6, 3, 2, 9, 4, 4, 2, 8, 3, 4, 3, 4, 6, 8, 6, 4, 9, 9, 6, 9,
        4, 2, 6, 1, 8, 9, 9, 0],
       [5, 6, 7, 9, 8, 1, 9, 1, 4, 4, 5, 2, 7, 0, 5, 3, 0, 6, 8, 3, 3, 5,
        2, 5, 6, 9, 9, 2, 6, 2],
       [1, 9, 3, 7, 8, 6, 0, 2, 8, 0, 8, 7, 0, 5, 4, 5, 9, 4, 5, 4, 4, 3,
        2, 2, 3, 8, 1, 8, 0, 0],
       [4, 5, 5, 2, 6, 8, 9, 7, 5, 7, 4, 7, 9, 3, 9, 7, 9, 1, 4, 8, 3, 5,
        0, 8, 0, 4, 3, 2, 5, 1],
       [2, 4, 8, 1, 9, 7, 1, 4, 6, 7, 0, 5, 0, 1, 0, 4, 9, 8, 5, 0, 0, 1,
        8, 2, 0, 4, 6, 5, 0, 4],
       [4, 5, 2, 4, 6, 4, 4, 4, 9, 9, 2, 0, 4, 8, 0, 2, 3, 0, 0, 7, 1, 7,
        6, 9, 9, 1, 5, 5, 2, 1],
       [0, 5, 4, 8, 0, 6, 4, 4, 1, 2, 6, 5, 1, 5, 1, 1, 1, 2, 1, 3, 8, 5,
        0, 7, 6, 9, 2, 0, 4, 3],
       [9, 7, 0, 9, 0, 3, 7, 4, 1, 5, 4, 1, 2, 8, 6, 6, 5, 7, 3, 7, 3, 7,
        8, 2, 2, 1, 9, 2, 2, 4],
       [4, 1, 9, 5, 4, 5, 0, 4, 8, 9, 1, 0, 9, 8, 9, 8, 8, 5, 7, 0, 9, 3,
        0, 7, 0, 2, 3, 7, 5, 9],
       [6, 7, 1, 9, 7, 2, 6, 2, 6, 1, 9, 5, 2, 2, 8, 6, 4, 9, 6, 8, 0, 6,
        5, 9, 8, 0, 3, 8, 3, 9],
       [2, 8, 1, 3, 5, 1, 7, 7, 0, 2, 9, 8, 4, 5, 3, 9, 1, 7, 5, 4, 8, 0,
        4, 5, 4, 5, 5, 6, 3, 7],
       [6, 8, 6, 2, 2, 7, 4, 3, 7, 5, 1, 3, 3, 5, 5, 0, 7, 5, 2, 8, 1, 7,
        9, 2, 4, 5, 9, 5, 3, 2],
       [3, 0, 3, 0, 0, 9, 5, 4, 3, 2, 0, 5, 1, 7, 9, 4, 6, 9, 1, 7, 1, 3,
        0, 4, 8, 0, 8, 7, 5, 6]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y1 = np.array(y)</span><br><span class="line">y1</span><br></pre></td></tr></table></figure>
<pre><code>array([[5, 8, 9, 5, 0, 0, 1, 7, 6, 9, 2, 4, 5, 2, 4, 2, 4, 7, 7, 9, 1, 7,
        0, 6, 9, 9, 7, 6, 9, 1],
       [0, 1, 8, 8, 3, 9, 8, 7, 3, 6, 5, 1, 9, 3, 4, 8, 1, 4, 0, 3, 9, 2,
        0, 4, 9, 2, 7, 7, 9, 8],
       [6, 9, 3, 7, 7, 4, 5, 9, 3, 6, 8, 0, 2, 7, 7, 9, 7, 3, 0, 8, 7, 7,
        1, 1, 3, 0, 8, 6, 4, 5],
       [6, 2, 5, 7, 8, 4, 4, 7, 7, 4, 9, 0, 2, 0, 7, 1, 7, 9, 8, 4, 0, 1,
        9, 8, 2, 3, 1, 2, 7, 2],
       [6, 0, 9, 2, 6, 6, 2, 7, 7, 0, 6, 5, 1, 4, 6, 0, 6, 5, 1, 2, 1, 5,
        4, 0, 7, 8, 9, 5, 7, 0],
       [9, 3, 9, 1, 4, 4, 6, 8, 8, 9, 2, 7, 5, 5, 4, 5, 8, 5, 8, 1, 1, 8,
        7, 0, 3, 4, 2, 0, 3, 5],
       [1, 2, 4, 3, 0, 6, 0, 7, 2, 8, 3, 0, 8, 4, 2, 9, 0, 3, 8, 1, 4, 3,
        3, 6, 7, 3, 5, 3, 2, 4],
       [4, 0, 3, 3, 8, 3, 5, 6, 7, 5, 1, 7, 0, 2, 8, 2, 1, 4, 0, 4, 1, 7,
        3, 1, 6, 6, 9, 6, 9, 6],
       [0, 0, 2, 9, 6, 0, 6, 7, 0, 3, 9, 0, 3, 4, 7, 5, 3, 8, 8, 0, 6, 7,
        9, 5, 4, 9, 5, 2, 5, 6],
       [6, 8, 7, 7, 7, 2, 6, 0, 5, 2, 1, 8, 5, 9, 4, 9, 1, 2, 0, 4, 7, 0,
        6, 2, 4, 3, 6, 7, 6, 3],
       [0, 6, 4, 7, 6, 2, 9, 5, 9, 9, 9, 8, 6, 4, 2, 9, 4, 0, 0, 3, 4, 9,
        3, 9, 1, 2, 5, 4, 0, 8],
       [2, 3, 9, 9, 4, 4, 8, 2, 1, 6, 3, 8, 9, 7, 0, 5, 2, 2, 8, 5, 0, 5,
        9, 8, 6, 6, 0, 4, 7, 3],
       [0, 1, 6, 0, 6, 1, 6, 4, 2, 5, 4, 6, 2, 9, 2, 7, 5, 0, 7, 8, 8, 8,
        0, 7, 2, 0, 7, 1, 1, 9],
       [5, 1, 5, 9, 6, 4, 9, 8, 7, 5, 1, 8, 0, 5, 3, 9, 0, 4, 8, 6, 2, 4,
        3, 2, 0, 0, 4, 2, 5, 0],
       [0, 3, 8, 5, 3, 1, 4, 7, 3, 2, 2, 2, 6, 6, 0, 1, 5, 6, 5, 8, 8, 5,
        5, 7, 5, 9, 1, 3, 9, 3],
       [3, 3, 6, 1, 3, 0, 5, 0, 5, 2, 7, 6, 4, 0, 2, 4, 8, 7, 6, 7, 7, 1,
        7, 7, 3, 8, 3, 0, 6, 3],
       [0, 6, 5, 9, 6, 4, 6, 6, 2, 2, 4, 1, 2, 3, 9, 3, 6, 7, 0, 3, 3, 6,
        8, 6, 5, 1, 3, 2, 6, 3],
       [6, 7, 2, 8, 0, 1, 8, 6, 0, 0, 1, 2, 7, 7, 4, 4, 0, 1, 0, 8, 5, 6,
        2, 5, 4, 3, 0, 6, 2, 1],
       [9, 4, 4, 0, 9, 8, 7, 7, 6, 1, 7, 2, 4, 5, 6, 7, 2, 0, 5, 2, 7, 9,
        9, 7, 1, 1, 4, 6, 5, 6],
       [4, 1, 1, 5, 1, 2, 6, 2, 3, 3, 2, 3, 0, 0, 1, 5, 0, 5, 8, 8, 0, 0,
        0, 9, 8, 5, 9, 3, 4, 0],
       [9, 8, 6, 3, 9, 9, 0, 8, 1, 6, 6, 1, 3, 7, 3, 2, 3, 0, 2, 8, 2, 9,
        0, 1, 3, 9, 4, 8, 8, 8],
       [2, 8, 6, 4, 9, 0, 5, 5, 6, 1, 7, 6, 5, 7, 1, 9, 7, 5, 6, 7, 6, 7,
        5, 6, 8, 7, 4, 2, 4, 0],
       [0, 3, 5, 9, 0, 3, 6, 5, 1, 1, 8, 4, 7, 0, 1, 7, 1, 5, 4, 5, 6, 2,
        5, 3, 9, 3, 9, 5, 1, 9],
       [7, 7, 0, 8, 6, 1, 2, 0, 4, 4, 6, 1, 0, 9, 4, 9, 3, 0, 5, 1, 1, 9,
        6, 0, 2, 8, 3, 7, 2, 5],
       [6, 0, 4, 2, 3, 1, 0, 5, 7, 0, 2, 2, 0, 9, 5, 1, 1, 6, 3, 2, 1, 1,
        2, 7, 5, 2, 9, 4, 7, 3],
       [5, 0, 2, 1, 4, 9, 4, 6, 9, 3, 8, 8, 7, 1, 8, 7, 8, 9, 2, 2, 5, 5,
        3, 5, 9, 2, 7, 4, 1, 6],
       [9, 8, 1, 8, 1, 6, 2, 6, 1, 8, 3, 7, 0, 7, 0, 0, 7, 3, 9, 5, 2, 5,
        1, 2, 5, 3, 3, 6, 1, 8],
       [1, 8, 6, 4, 6, 9, 5, 4, 7, 2, 0, 2, 0, 5, 9, 4, 1, 4, 5, 2, 9, 3,
        1, 5, 1, 1, 7, 1, 2, 6],
       [0, 7, 7, 4, 3, 2, 7, 8, 5, 2, 4, 9, 2, 2, 3, 5, 9, 6, 4, 9, 0, 2,
        8, 3, 7, 3, 9, 2, 3, 8],
       [8, 0, 2, 6, 8, 3, 6, 4, 9, 7, 6, 3, 2, 9, 1, 5, 5, 6, 9, 4, 6, 7,
        8, 5, 7, 2, 5, 3, 4, 5]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit x1.dot(y1)</span><br></pre></td></tr></table></figure>
<pre><code>22.8 µs ± 400 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit np.dot(x1, y1)</span><br></pre></td></tr></table></figure>
<pre><code>22.9 µs ± 853 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit np.dot(x.values, y.values)</span><br></pre></td></tr></table></figure>
<pre><code>36.8 µs ± 1.07 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x2 = list(x1)</span><br><span class="line">y2 = list(y1)</span><br><span class="line">x3 = []</span><br><span class="line">y3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x2:</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        res.append(int(j))</span><br><span class="line">    x3.append(res)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> y2:</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        res.append(int(j))</span><br><span class="line">    y3.append(res)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">        row = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(y[<span class="number">0</span>])):</span><br><span class="line">            sum_row = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(len(x[<span class="number">0</span>])):</span><br><span class="line">                sum_row += x[i][k]*y[k][j]</span><br><span class="line">            row.append(sum_row)</span><br><span class="line">        res.append(row)</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit f(x3, y3)</span><br></pre></td></tr></table></figure>
<pre><code>3.89 ms ± 168 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</code></pre><p><strong>一般来说，纯粹的计算在Numpy里执行的更快</strong></p>
<p>Numpy更侧重于计算，Pandas更侧重于数据处理</p>
<p><strong>（3）广播运算</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">x = pd.DataFrame(np.random.randint(<span class="number">10</span>, size=(<span class="number">3</span>, <span class="number">3</span>)), columns=list(<span class="string">"ABC"</span>))</span><br><span class="line">x</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>按行广播</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<pre><code>A    6
B    3
C    7
Name: 0, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x/x.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.666667</td>
      <td>2.0</td>
      <td>1.285714</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.333333</td>
      <td>2.0</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>按列广播</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x.A</span><br></pre></td></tr></table></figure>
<pre><code>0    6
1    4
2    2
Name: A, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x.div(x.A, axis=<span class="number">0</span>)             <span class="comment"># add sub div mul</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.5</td>
      <td>1.166667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.250000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.500000</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x.div(x.iloc[<span class="number">0</span>], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.666667</td>
      <td>2.0</td>
      <td>1.285714</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.333333</td>
      <td>2.0</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>3、新的用法</strong></p>
<p><strong>（1）索引对齐</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A = pd.DataFrame(np.random.randint(<span class="number">0</span>, <span class="number">20</span>, size=(<span class="number">2</span>, <span class="number">2</span>)), columns=list(<span class="string">"AB"</span>))</span><br><span class="line">A</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">B = pd.DataFrame(np.random.randint(<span class="number">0</span>, <span class="number">10</span>, size=(<span class="number">3</span>, <span class="number">3</span>)), columns=list(<span class="string">"ABC"</span>))</span><br><span class="line">B</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>8</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>pandas会自动对齐两个对象的索引，没有的值用np.nan表示</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A+B</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.0</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>缺省值也可用fill_value来填充</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.add(B, fill_value=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.0</td>
      <td>12.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.0</td>
      <td>1.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>8.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A*B</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>21.0</td>
      <td>35.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.0</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（2）统计相关</strong></p>
<ul>
<li>数据种类统计</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = np.random.randint(<span class="number">3</span>, size=<span class="number">20</span>)</span><br><span class="line">y</span><br></pre></td></tr></table></figure>
<pre><code>array([2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 0, 2, 0, 2, 2, 0, 0, 2, 1])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.unique(y)</span><br></pre></td></tr></table></figure>
<pre><code>array([0, 1, 2])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line">Counter(y)</span><br></pre></td></tr></table></figure>
<pre><code>Counter({2: 11, 1: 5, 0: 4})
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y1 = pd.DataFrame(y, columns=[<span class="string">"A"</span>])</span><br><span class="line">y1</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.unique(y1)</span><br></pre></td></tr></table></figure>
<pre><code>array([0, 1, 2])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y1[<span class="string">"A"</span>].value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>2    11
1     5
0     4
Name: A, dtype: int64
</code></pre><ul>
<li>产生新的结果，并进行排序</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">"BeiJing"</span>: <span class="number">2154</span>,</span><br><span class="line">                   <span class="string">"ShangHai"</span>: <span class="number">2424</span>,</span><br><span class="line">                   <span class="string">"ShenZhen"</span>: <span class="number">1303</span>,</span><br><span class="line">                   <span class="string">"HangZhou"</span>: <span class="number">981</span> &#125;</span><br><span class="line">population = pd.Series(population_dict) </span><br><span class="line"></span><br><span class="line">GDP_dict = &#123;<span class="string">"BeiJing"</span>: <span class="number">30320</span>,</span><br><span class="line">            <span class="string">"ShangHai"</span>: <span class="number">32680</span>,</span><br><span class="line">            <span class="string">"ShenZhen"</span>: <span class="number">24222</span>,</span><br><span class="line">            <span class="string">"HangZhou"</span>: <span class="number">13468</span> &#125;</span><br><span class="line">GDP = pd.Series(GDP_dict)</span><br><span class="line"></span><br><span class="line">city_info = pd.DataFrame(&#123;<span class="string">"population"</span>: population,<span class="string">"GDP"</span>: GDP&#125;)</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">city_info[<span class="string">"per_GDP"</span>] = city_info[<span class="string">"GDP"</span>]/city_info[<span class="string">"population"</span>]</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>per_GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
      <td>14.076137</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
      <td>13.481848</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
      <td>18.589409</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
      <td>13.728848</td>
    </tr>
  </tbody>
</table>
</div>



<p>递增排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">city_info.sort_values(by=<span class="string">"per_GDP"</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>per_GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
      <td>13.481848</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
      <td>13.728848</td>
    </tr>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
      <td>14.076137</td>
    </tr>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
      <td>18.589409</td>
    </tr>
  </tbody>
</table>
</div>



<p>递减排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">city_info.sort_values(by=<span class="string">"per_GDP"</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>GDP</th>
      <th>per_GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ShenZhen</th>
      <td>1303</td>
      <td>24222</td>
      <td>18.589409</td>
    </tr>
    <tr>
      <th>BeiJing</th>
      <td>2154</td>
      <td>30320</td>
      <td>14.076137</td>
    </tr>
    <tr>
      <th>HangZhou</th>
      <td>981</td>
      <td>13468</td>
      <td>13.728848</td>
    </tr>
    <tr>
      <th>ShangHai</th>
      <td>2424</td>
      <td>32680</td>
      <td>13.481848</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>按轴进行排序</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.random.randint(<span class="number">20</span>, size=(<span class="number">3</span>, <span class="number">4</span>)), index=[<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>], columns=list(<span class="string">"CBAD"</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>B</th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>13</td>
      <td>17</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>19</td>
      <td>14</td>
      <td>6</td>
    </tr>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>7</td>
      <td>14</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



<p>行排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.sort_index()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>B</th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>7</td>
      <td>14</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>19</td>
      <td>14</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>13</td>
      <td>17</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>



<p>列排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.sort_index(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>17</td>
      <td>13</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14</td>
      <td>19</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>0</th>
      <td>14</td>
      <td>7</td>
      <td>11</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
      <th>C</th>
      <th>B</th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>3</td>
      <td>13</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>1</td>
      <td>19</td>
      <td>14</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>11</td>
      <td>7</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>统计方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.normal(<span class="number">2</span>, <span class="number">4</span>, size=(<span class="number">6</span>, <span class="number">4</span>)),columns=list(<span class="string">"ABCD"</span>))</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.082198</td>
      <td>3.557396</td>
      <td>-3.060476</td>
      <td>6.367969</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.113252</td>
      <td>6.774559</td>
      <td>2.874553</td>
      <td>5.527044</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.036341</td>
      <td>-4.333177</td>
      <td>5.094802</td>
      <td>-0.152567</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-3.386712</td>
      <td>-1.522365</td>
      <td>-2.522209</td>
      <td>2.537716</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.328491</td>
      <td>5.550994</td>
      <td>5.577329</td>
      <td>5.019991</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.171336</td>
      <td>-0.493910</td>
      <td>-4.032613</td>
      <td>6.398588</td>
    </tr>
  </tbody>
</table>
</div>



<p>非空个数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.count()</span><br></pre></td></tr></table></figure>
<pre><code>A    6
B    6
C    6
D    6
dtype: int64
</code></pre><p>求和</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sum()</span><br></pre></td></tr></table></figure>
<pre><code>A    14.272224
B     9.533497
C     3.931385
D    25.698741
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sum(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>0     7.947086
1    28.289408
2    -1.427283
3    -4.893571
4    20.476806
5     3.043402
dtype: float64
</code></pre><p>最大值 最小值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.min()</span><br></pre></td></tr></table></figure>
<pre><code>A   -3.386712
B   -4.333177
C   -4.032613
D   -0.152567
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.max(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>0     6.367969
1    13.113252
2     5.094802
3     2.537716
4     5.577329
5     6.398588
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.082198</td>
      <td>3.557396</td>
      <td>-3.060476</td>
      <td>6.367969</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.113252</td>
      <td>6.774559</td>
      <td>2.874553</td>
      <td>5.527044</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.036341</td>
      <td>-4.333177</td>
      <td>5.094802</td>
      <td>-0.152567</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-3.386712</td>
      <td>-1.522365</td>
      <td>-2.522209</td>
      <td>2.537716</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.328491</td>
      <td>5.550994</td>
      <td>5.577329</td>
      <td>5.019991</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.171336</td>
      <td>-0.493910</td>
      <td>-4.032613</td>
      <td>6.398588</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.idxmax()</span><br></pre></td></tr></table></figure>
<pre><code>A    1
B    1
C    4
D    5
dtype: int64
</code></pre><p>均值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.mean()</span><br></pre></td></tr></table></figure>
<pre><code>A    2.378704
B    1.588916
C    0.655231
D    4.283124
dtype: float64
</code></pre><p>方差</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.var()</span><br></pre></td></tr></table></figure>
<pre><code>A    34.980702
B    19.110656
C    18.948144
D     6.726776
dtype: float64
</code></pre><p>标准差</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.std()</span><br></pre></td></tr></table></figure>
<pre><code>A    5.914449
B    4.371574
C    4.352947
D    2.593603
dtype: float64
</code></pre><p>中位数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.median()</span><br></pre></td></tr></table></figure>
<pre><code>A    1.126767
B    1.531743
C    0.176172
D    5.273518
dtype: float64
</code></pre><p>众数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.random.randint(<span class="number">5</span>, size=(<span class="number">10</span>, <span class="number">2</span>)), columns=list(<span class="string">"AB"</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.mode() <span class="comment"># 众数</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



<p>75%分位数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.quantile(<span class="number">0.75</span>)</span><br></pre></td></tr></table></figure>
<pre><code>A    3.539202
B    5.052594
C    4.539740
D    6.157738
Name: 0.75, dtype: float64
</code></pre><p>一网打尽</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.378704</td>
      <td>1.588916</td>
      <td>0.655231</td>
      <td>4.283124</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.914449</td>
      <td>4.371574</td>
      <td>4.352947</td>
      <td>2.593603</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-3.386712</td>
      <td>-4.333177</td>
      <td>-4.032613</td>
      <td>-0.152567</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-1.256706</td>
      <td>-1.265251</td>
      <td>-2.925910</td>
      <td>3.158284</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.126767</td>
      <td>1.531743</td>
      <td>0.176172</td>
      <td>5.273518</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.539202</td>
      <td>5.052594</td>
      <td>4.539740</td>
      <td>6.157738</td>
    </tr>
    <tr>
      <th>max</th>
      <td>13.113252</td>
      <td>6.774559</td>
      <td>5.577329</td>
      <td>6.398588</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data_2 = pd.DataFrame([[<span class="string">"a"</span>, <span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>],</span><br><span class="line">                       [<span class="string">"c"</span>, <span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"b"</span>],</span><br><span class="line">                       [<span class="string">"a"</span>, <span class="string">"a"</span>, <span class="string">"d"</span>, <span class="string">"c"</span>]], columns=list(<span class="string">"ABCD"</span>))</span><br><span class="line">data_2</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>a</td>
      <td>c</td>
      <td>d</td>
    </tr>
    <tr>
      <th>1</th>
      <td>c</td>
      <td>a</td>
      <td>c</td>
      <td>b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>a</td>
      <td>d</td>
      <td>c</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_2.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>top</th>
      <td>a</td>
      <td>a</td>
      <td>c</td>
      <td>b</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



<p>相关性系数和协方差</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.corr()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1.000000</td>
      <td>0.831063</td>
      <td>0.331060</td>
      <td>0.510821</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.831063</td>
      <td>1.000000</td>
      <td>0.179244</td>
      <td>0.719112</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.331060</td>
      <td>0.179244</td>
      <td>1.000000</td>
      <td>-0.450365</td>
    </tr>
    <tr>
      <th>D</th>
      <td>0.510821</td>
      <td>0.719112</td>
      <td>-0.450365</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.corrwith(df[<span class="string">"A"</span>])</span><br></pre></td></tr></table></figure>
<pre><code>A    1.000000
B    0.831063
C    0.331060
D    0.510821
dtype: float64
</code></pre><p>自定义输出</p>
<p>apply（method）的用法：使用method方法默认对每一列进行相应的操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.082198</td>
      <td>3.557396</td>
      <td>-3.060476</td>
      <td>6.367969</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.113252</td>
      <td>6.774559</td>
      <td>2.874553</td>
      <td>5.527044</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.036341</td>
      <td>-4.333177</td>
      <td>5.094802</td>
      <td>-0.152567</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-3.386712</td>
      <td>-1.522365</td>
      <td>-2.522209</td>
      <td>2.537716</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.328491</td>
      <td>5.550994</td>
      <td>5.577329</td>
      <td>5.019991</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.171336</td>
      <td>-0.493910</td>
      <td>-4.032613</td>
      <td>6.398588</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(np.cumsum)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.082198</td>
      <td>3.557396</td>
      <td>-3.060476</td>
      <td>6.367969</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14.195450</td>
      <td>10.331955</td>
      <td>-0.185923</td>
      <td>11.895013</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.159109</td>
      <td>5.998778</td>
      <td>4.908878</td>
      <td>11.742447</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.772397</td>
      <td>4.476413</td>
      <td>2.386669</td>
      <td>14.280162</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.100888</td>
      <td>10.027406</td>
      <td>7.963999</td>
      <td>19.300153</td>
    </tr>
    <tr>
      <th>5</th>
      <td>14.272224</td>
      <td>9.533497</td>
      <td>3.931385</td>
      <td>25.698741</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(np.cumsum, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.082198</td>
      <td>4.639594</td>
      <td>1.579117</td>
      <td>7.947086</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.113252</td>
      <td>19.887811</td>
      <td>22.762364</td>
      <td>28.289408</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.036341</td>
      <td>-6.369518</td>
      <td>-1.274717</td>
      <td>-1.427283</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-3.386712</td>
      <td>-4.909077</td>
      <td>-7.431287</td>
      <td>-4.893571</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.328491</td>
      <td>9.879485</td>
      <td>15.456814</td>
      <td>20.476806</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.171336</td>
      <td>0.677427</td>
      <td>-3.355186</td>
      <td>3.043402</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(sum)</span><br></pre></td></tr></table></figure>
<pre><code>A    14.272224
B     9.533497
C     3.931385
D    25.698741
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sum()</span><br></pre></td></tr></table></figure>
<pre><code>A    14.272224
B     9.533497
C     3.931385
D    25.698741
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(<span class="keyword">lambda</span> x: x.max()-x.min())</span><br></pre></td></tr></table></figure>
<pre><code>A    16.499965
B    11.107736
C     9.609942
D     6.551155
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_describe</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> pd.Series([x.count(), x.mean(), x.max(), x.idxmin(), x.std()], \</span><br><span class="line">                     index=[<span class="string">"Count"</span>, <span class="string">"mean"</span>, <span class="string">"max"</span>, <span class="string">"idxmin"</span>, <span class="string">"std"</span>])</span><br><span class="line">df.apply(my_describe)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Count</th>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.378704</td>
      <td>1.588916</td>
      <td>0.655231</td>
      <td>4.283124</td>
    </tr>
    <tr>
      <th>max</th>
      <td>13.113252</td>
      <td>6.774559</td>
      <td>5.577329</td>
      <td>6.398588</td>
    </tr>
    <tr>
      <th>idxmin</th>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>5.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.914449</td>
      <td>4.371574</td>
      <td>4.352947</td>
      <td>2.593603</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="12-4-缺失值处理"><a href="#12-4-缺失值处理" class="headerlink" title="12.4 缺失值处理"></a>12.4 缺失值处理</h2><p><strong>1、发现缺失值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.array([[<span class="number">1</span>, np.nan, <span class="number">2</span>],</span><br><span class="line">                              [np.nan, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">                              [<span class="number">5</span>, <span class="number">6</span>, <span class="literal">None</span>]]), columns=[<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>注意：有None、字符串等，数据类型全部变为object，它比int和float更消耗资源</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dtypes</span><br></pre></td></tr></table></figure>
<pre><code>A    object
B    object
C    object
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.isnull()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.notnull()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>2、删除缺失值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.array([[<span class="number">1</span>, np.nan, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">                              [np.nan, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                              [<span class="number">7</span>, <span class="number">8</span>, np.nan, <span class="number">9</span>],</span><br><span class="line">                              [<span class="number">10</span>, <span class="number">11</span> , <span class="number">12</span>, <span class="number">13</span>]]), columns=[<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>注意：np.nan是一种特殊的浮点数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dtypes</span><br></pre></td></tr></table></figure>
<pre><code>A    float64
B    float64
C    float64
D    float64
dtype: object
</code></pre><p><strong>（1）删除整行</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna() <span class="comment"># 丢弃有缺失值的行</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（2）删除整列</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna(axis=<span class="string">"columns"</span>) <span class="comment"># 丢弃有缺失值的列</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">"D"</span>] = np.nan</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna(axis=<span class="string">"columns"</span>, how=<span class="string">"all"</span>) <span class="comment"># 加入how='all'参数，则丢弃全为缺失值的列</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna(axis=<span class="string">"columns"</span>, how=<span class="string">"any"</span>) <span class="comment"># 加入how='any'参数，则丢弃有缺失值的列</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
    </tr>
    <tr>
      <th>1</th>
    </tr>
    <tr>
      <th>2</th>
    </tr>
    <tr>
      <th>3</th>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.loc[<span class="number">3</span>] = np.nan</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.dropna(how=<span class="string">"all"</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>3、填充缺失值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.array([[<span class="number">1</span>, np.nan, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">                              [np.nan, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                              [<span class="number">7</span>, <span class="number">8</span>, np.nan, <span class="number">9</span>],</span><br><span class="line">                              [<span class="number">10</span>, <span class="number">11</span> , <span class="number">12</span>, <span class="number">13</span>]]), columns=[<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.fillna(value=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>用均值进行替换</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fill = data.mean()</span><br><span class="line">fill</span><br></pre></td></tr></table></figure>
<pre><code>A    6.000000
B    7.666667
C    6.333333
D    7.750000
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.fillna(value=fill)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>7.666667</td>
      <td>2.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.0</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.000000</td>
      <td>6.333333</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.000000</td>
      <td>12.000000</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fill = data.stack().mean()</span><br><span class="line">fill</span><br></pre></td></tr></table></figure>
<pre><code>7.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.fillna(value=fill)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="12-5-合并数据"><a href="#12-5-合并数据" class="headerlink" title="12.5 合并数据"></a>12.5 合并数据</h2><ul>
<li>构造一个生产DataFrame的函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_df</span><span class="params">(cols, ind)</span>:</span></span><br><span class="line">    <span class="string">"一个简单的DataFrame"</span></span><br><span class="line">    data = &#123;c: [str(c)+str(i) <span class="keyword">for</span> i <span class="keyword">in</span> ind]  <span class="keyword">for</span> c <span class="keyword">in</span> cols&#125;</span><br><span class="line">    <span class="keyword">return</span> pd.DataFrame(data, ind)</span><br><span class="line"></span><br><span class="line">make_df(<span class="string">"ABC"</span>, range(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>垂直合并</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_1 = make_df(<span class="string">"AB"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_2 = make_df(<span class="string">"AB"</span>, [<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">print(df_1)</span><br><span class="line">print(df_2)</span><br></pre></td></tr></table></figure>
<pre><code>    A   B
1  A1  B1
2  A2  B2
    A   B
3  A3  B3
4  A4  B4
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_1, df_2])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>水平合并</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_3 = make_df(<span class="string">"AB"</span>, [<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">df_4 = make_df(<span class="string">"CD"</span>, [<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">print(df_3)</span><br><span class="line">print(df_4)</span><br></pre></td></tr></table></figure>
<pre><code>    A   B
0  A0  B0
1  A1  B1
    C   D
0  C0  D0
1  C1  D1
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_3, df_4], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>索引重叠</li>
</ul>
<p>行重叠</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_5 = make_df(<span class="string">"AB"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_6 = make_df(<span class="string">"AB"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">print(df_5)</span><br><span class="line">print(df_6)</span><br></pre></td></tr></table></figure>
<pre><code>    A   B
1  A1  B1
2  A2  B2
    A   B
1  A1  B1
2  A2  B2
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_5, df_6])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_5, df_6],ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
  </tbody>
</table>
</div>



<p>列重叠</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_7 = make_df(<span class="string">"ABC"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_8 = make_df(<span class="string">"BCD"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">print(df_7)</span><br><span class="line">print(df_8)</span><br></pre></td></tr></table></figure>
<pre><code>    A   B   C
1  A1  B1  C1
2  A2  B2  C2
    B   C   D
1  B1  C1  D1
2  B2  C2  D2
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_7, df_8], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df_7, df_8],axis=<span class="number">1</span>, ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>对齐合并merge()</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_9 = make_df(<span class="string">"AB"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_10 = make_df(<span class="string">"BC"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">print(df_9)</span><br><span class="line">print(df_10)</span><br></pre></td></tr></table></figure>
<pre><code>    A   B
1  A1  B1
2  A2  B2
    B   C
1  B1  C1
2  B2  C2
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df_9, df_10)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df_9 = make_df(<span class="string">"AB"</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">df_10 = make_df(<span class="string">"CB"</span>, [<span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line">print(df_9)</span><br><span class="line">print(df_10)</span><br></pre></td></tr></table></figure>
<pre><code>    A   B
1  A1  B1
2  A2  B2
    C   B
2  C2  B2
1  C1  B1
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df_9, df_10)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>
</div>



<p>【例】 合并城市信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">population_dict = &#123;<span class="string">"city"</span>: (<span class="string">"BeiJing"</span>, <span class="string">"HangZhou"</span>, <span class="string">"ShenZhen"</span>),</span><br><span class="line">                   <span class="string">"pop"</span>: (<span class="number">2154</span>, <span class="number">981</span>, <span class="number">1303</span>)&#125;</span><br><span class="line">population = pd.DataFrame(population_dict)</span><br><span class="line">population</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>2154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HangZhou</td>
      <td>981</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ShenZhen</td>
      <td>1303</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GDP_dict = &#123;<span class="string">"city"</span>: (<span class="string">"BeiJing"</span>, <span class="string">"ShangHai"</span>, <span class="string">"HangZhou"</span>),</span><br><span class="line">            <span class="string">"GDP"</span>: (<span class="number">30320</span>, <span class="number">32680</span>, <span class="number">13468</span>)&#125;</span><br><span class="line">GDP = pd.DataFrame(GDP_dict)</span><br><span class="line">GDP</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ShangHai</td>
      <td>32680</td>
    </tr>
    <tr>
      <th>2</th>
      <td>HangZhou</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">city_info = pd.merge(population, GDP)</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HangZhou</td>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">city_info = pd.merge(population, GDP, how=<span class="string">"outer"</span>)</span><br><span class="line">city_info</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>pop</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BeiJing</td>
      <td>2154.0</td>
      <td>30320.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HangZhou</td>
      <td>981.0</td>
      <td>13468.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ShenZhen</td>
      <td>1303.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ShangHai</td>
      <td>NaN</td>
      <td>32680.0</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="12-6-分组和数据透视表"><a href="#12-6-分组和数据透视表" class="headerlink" title="12.6 分组和数据透视表"></a>12.6 分组和数据透视表</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">"key"</span>:[<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"C"</span>, <span class="string">"B"</span>, <span class="string">"A"</span>],</span><br><span class="line">                  <span class="string">"data1"</span>: range(<span class="number">6</span>),</span><br><span class="line">                  <span class="string">"data2"</span>: np.random.randint(<span class="number">0</span>, <span class="number">10</span>, size=<span class="number">6</span>)&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（1）分组</strong></p>
<ul>
<li>延迟计算</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>) <span class="comment"># 将原DataFrame按key分组</span></span><br></pre></td></tr></table></figure>
<pre><code>&lt;pandas.core.groupby.groupby.DataFrameGroupBy object at 0x0000012E335827B8&gt;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>).sum()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>B</th>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>C</th>
      <td>5</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>).mean()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>2.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>2.5</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2.5</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> df.groupby(<span class="string">"key"</span>):</span><br><span class="line">    print(str(i))</span><br></pre></td></tr></table></figure>
<pre><code>(&#39;A&#39;,   key  data1  data2
0   A      0      3
5   A      5      3)
(&#39;B&#39;,   key  data1  data2
1   B      1      3
4   B      4      6)
(&#39;C&#39;,   key  data1  data2
2   C      2      4
3   C      3      6)
</code></pre><ul>
<li>按列取值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>)[<span class="string">"data2"</span>].sum()</span><br></pre></td></tr></table></figure>
<pre><code>key
A     6
B     9
C    10
Name: data2, dtype: int32
</code></pre><ul>
<li>按组迭代</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> data, group <span class="keyword">in</span> df.groupby(<span class="string">"key"</span>):</span><br><span class="line">    print(<span class="string">"&#123;0:5&#125; shape=&#123;1&#125;"</span>.format(data, group.shape))</span><br></pre></td></tr></table></figure>
<pre><code>A     shape=(2, 3)
B     shape=(2, 3)
C     shape=(2, 3)
</code></pre><ul>
<li>调用方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>)[<span class="string">"data1"</span>].describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>2.0</td>
      <td>2.5</td>
      <td>3.535534</td>
      <td>0.0</td>
      <td>1.25</td>
      <td>2.5</td>
      <td>3.75</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>2.0</td>
      <td>2.5</td>
      <td>2.121320</td>
      <td>1.0</td>
      <td>1.75</td>
      <td>2.5</td>
      <td>3.25</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2.0</td>
      <td>2.5</td>
      <td>0.707107</td>
      <td>2.0</td>
      <td>2.25</td>
      <td>2.5</td>
      <td>2.75</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>支持更复杂的操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>).aggregate([<span class="string">"min"</span>, <span class="string">"median"</span>, <span class="string">"max"</span>])</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">data1</th>
      <th colspan="3" halign="left">data2</th>
    </tr>
    <tr>
      <th></th>
      <th>min</th>
      <th>median</th>
      <th>max</th>
      <th>min</th>
      <th>median</th>
      <th>max</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>2.5</td>
      <td>5</td>
      <td>3</td>
      <td>3.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1</td>
      <td>2.5</td>
      <td>4</td>
      <td>3</td>
      <td>4.5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2</td>
      <td>2.5</td>
      <td>3</td>
      <td>4</td>
      <td>5.0</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>过滤</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter_func</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x[<span class="string">"data2"</span>].std() &gt; <span class="number">3</span></span><br><span class="line">df.groupby(<span class="string">"key"</span>)[<span class="string">"data2"</span>].std()</span><br></pre></td></tr></table></figure>
<pre><code>key
A    0.000000
B    2.121320
C    1.414214
Name: data2, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>).filter(filter_func)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



<ul>
<li>转换</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>).transform(<span class="keyword">lambda</span> x: x-x.mean())</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.5</td>
      <td>-1.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.5</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.5</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.5</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>).apply(<span class="keyword">lambda</span> x: x-x.mean())</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.5</td>
      <td>-1.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.5</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.5</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.5</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>apply（）方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">norm_by_data2</span><span class="params">(x)</span>:</span></span><br><span class="line">    x[<span class="string">"data1"</span>] /= x[<span class="string">"data2"</span>].sum()</span><br><span class="line">    <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">"key"</span>).apply(norm_by_data2)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0.000000</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>0.111111</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>0.200000</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>0.300000</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>0.444444</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>0.833333</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>将列表、数组设为分组键</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">L = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A</td>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(L).sum()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>用字典将索引映射到分组</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df2 = df.set_index(<span class="string">"key"</span>)</span><br><span class="line">df2</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>C</th>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>B</th>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>A</th>
      <td>5</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapping = &#123;<span class="string">"A"</span>: <span class="string">"first"</span>, <span class="string">"B"</span>: <span class="string">"constant"</span>, <span class="string">"C"</span>: <span class="string">"constant"</span>&#125;</span><br><span class="line">df2.groupby(mapping).sum()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>constant</th>
      <td>10</td>
      <td>19</td>
    </tr>
    <tr>
      <th>first</th>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>任意Python函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2.groupby(str.lower).mean()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>2.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2.5</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2.5</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>多个有效值组成的列表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2.groupby([str.lower, mapping]).mean()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <th>first</th>
      <td>2.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>b</th>
      <th>constant</th>
      <td>2.5</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>c</th>
      <th>constant</th>
      <td>2.5</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>



<p>【例1】 行星观测数据处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">planets = sns.load_dataset(<span class="string">"planets"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.shape</span><br></pre></td></tr></table></figure>
<pre><code>(1035, 6)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>269.300</td>
      <td>7.10</td>
      <td>77.40</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>874.774</td>
      <td>2.21</td>
      <td>56.95</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>763.000</td>
      <td>2.60</td>
      <td>19.84</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>326.030</td>
      <td>19.40</td>
      <td>110.62</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>516.220</td>
      <td>10.50</td>
      <td>119.47</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1035.000000</td>
      <td>992.000000</td>
      <td>513.000000</td>
      <td>808.000000</td>
      <td>1035.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.785507</td>
      <td>2002.917596</td>
      <td>2.638161</td>
      <td>264.069282</td>
      <td>2009.070531</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.240976</td>
      <td>26014.728304</td>
      <td>3.818617</td>
      <td>733.116493</td>
      <td>3.972567</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.090706</td>
      <td>0.003600</td>
      <td>1.350000</td>
      <td>1989.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>5.442540</td>
      <td>0.229000</td>
      <td>32.560000</td>
      <td>2007.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>39.979500</td>
      <td>1.260000</td>
      <td>55.250000</td>
      <td>2010.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>526.005000</td>
      <td>3.040000</td>
      <td>178.500000</td>
      <td>2012.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.000000</td>
      <td>730000.000000</td>
      <td>25.000000</td>
      <td>8500.000000</td>
      <td>2014.000000</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>269.300</td>
      <td>7.10</td>
      <td>77.40</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>874.774</td>
      <td>2.21</td>
      <td>56.95</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>763.000</td>
      <td>2.60</td>
      <td>19.84</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>326.030</td>
      <td>19.40</td>
      <td>110.62</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>516.220</td>
      <td>10.50</td>
      <td>119.47</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decade = <span class="number">10</span> * (planets[<span class="string">"year"</span>] // <span class="number">10</span>)</span><br><span class="line">decade.head()</span><br></pre></td></tr></table></figure>
<pre><code>0    2000
1    2000
2    2010
3    2000
4    2000
Name: year, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">decade = decade.astype(str) + <span class="string">"s"</span></span><br><span class="line">decade.name = <span class="string">"decade"</span></span><br><span class="line">decade.head()</span><br></pre></td></tr></table></figure>
<pre><code>0    2000s
1    2000s
2    2010s
3    2000s
4    2000s
Name: decade, dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>269.300</td>
      <td>7.10</td>
      <td>77.40</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>874.774</td>
      <td>2.21</td>
      <td>56.95</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>763.000</td>
      <td>2.60</td>
      <td>19.84</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>326.030</td>
      <td>19.40</td>
      <td>110.62</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>516.220</td>
      <td>10.50</td>
      <td>119.47</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.groupby([<span class="string">"method"</span>, decade]).sum()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
    <tr>
      <th>method</th>
      <th>decade</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Astrometry</th>
      <th>2010s</th>
      <td>2</td>
      <td>1.262360e+03</td>
      <td>0.00000</td>
      <td>35.75</td>
      <td>4023</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Eclipse Timing Variations</th>
      <th>2000s</th>
      <td>5</td>
      <td>1.930800e+04</td>
      <td>6.05000</td>
      <td>261.44</td>
      <td>6025</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>10</td>
      <td>2.345680e+04</td>
      <td>4.20000</td>
      <td>1000.00</td>
      <td>12065</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Imaging</th>
      <th>2000s</th>
      <td>29</td>
      <td>1.350935e+06</td>
      <td>0.00000</td>
      <td>956.83</td>
      <td>40139</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>21</td>
      <td>6.803750e+04</td>
      <td>0.00000</td>
      <td>1210.08</td>
      <td>36208</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Microlensing</th>
      <th>2000s</th>
      <td>12</td>
      <td>1.732500e+04</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>20070</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>15</td>
      <td>4.750000e+03</td>
      <td>0.00000</td>
      <td>41440.00</td>
      <td>26155</td>
    </tr>
    <tr>
      <th>Orbital Brightness Modulation</th>
      <th>2010s</th>
      <td>5</td>
      <td>2.127920e+00</td>
      <td>0.00000</td>
      <td>2360.00</td>
      <td>6035</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Pulsar Timing</th>
      <th>1990s</th>
      <td>9</td>
      <td>1.900153e+02</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>5978</td>
    </tr>
    <tr>
      <th>2000s</th>
      <td>1</td>
      <td>3.652500e+04</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>2003</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>1</td>
      <td>9.070629e-02</td>
      <td>0.00000</td>
      <td>1200.00</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>Pulsation Timing Variations</th>
      <th>2000s</th>
      <td>1</td>
      <td>1.170000e+03</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>2007</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Radial Velocity</th>
      <th>1980s</th>
      <td>1</td>
      <td>8.388800e+01</td>
      <td>11.68000</td>
      <td>40.57</td>
      <td>1989</td>
    </tr>
    <tr>
      <th>1990s</th>
      <td>52</td>
      <td>1.091561e+04</td>
      <td>68.17820</td>
      <td>723.71</td>
      <td>55943</td>
    </tr>
    <tr>
      <th>2000s</th>
      <td>475</td>
      <td>2.633526e+05</td>
      <td>945.31928</td>
      <td>15201.16</td>
      <td>619775</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>424</td>
      <td>1.809630e+05</td>
      <td>316.47890</td>
      <td>11382.67</td>
      <td>432451</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Transit</th>
      <th>2000s</th>
      <td>64</td>
      <td>2.897102e+02</td>
      <td>0.00000</td>
      <td>31823.31</td>
      <td>124462</td>
    </tr>
    <tr>
      <th>2010s</th>
      <td>712</td>
      <td>8.087813e+03</td>
      <td>1.47000</td>
      <td>102419.46</td>
      <td>673999</td>
    </tr>
    <tr>
      <th>Transit Timing Variations</th>
      <th>2010s</th>
      <td>9</td>
      <td>2.393505e+02</td>
      <td>0.00000</td>
      <td>3313.00</td>
      <td>8050</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">planets.groupby([<span class="string">"method"</span>, decade])[[<span class="string">"number"</span>]].sum().unstack().fillna(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">number</th>
    </tr>
    <tr>
      <th>decade</th>
      <th>1980s</th>
      <th>1990s</th>
      <th>2000s</th>
      <th>2010s</th>
    </tr>
    <tr>
      <th>method</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Astrometry</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Eclipse Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Imaging</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>29.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Microlensing</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>Orbital Brightness Modulation</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Pulsar Timing</th>
      <td>0.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Pulsation Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Radial Velocity</th>
      <td>1.0</td>
      <td>52.0</td>
      <td>475.0</td>
      <td>424.0</td>
    </tr>
    <tr>
      <th>Transit</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>64.0</td>
      <td>712.0</td>
    </tr>
    <tr>
      <th>Transit Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>（2）数据透视表</strong></p>
<p>【例2】泰坦尼克号乘客数据分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">titanic = sns.load_dataset(<span class="string">"titanic"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T = titanic[titanic.age.notnull()].copy()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T.age.apply(<span class="keyword">lambda</span> x: <span class="number">60</span> <span class="keyword">if</span> x&gt;=<span class="number">60</span> <span class="keyword">else</span> x)</span><br><span class="line">T.age.value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>24.00    30
22.00    27
18.00    26
19.00    25
30.00    25
28.00    25
21.00    24
25.00    23
36.00    22
29.00    20
32.00    18
27.00    18
35.00    18
26.00    18
16.00    17
31.00    17
20.00    15
33.00    15
23.00    15
34.00    15
39.00    14
17.00    13
42.00    13
40.00    13
45.00    12
38.00    11
50.00    10
2.00     10
4.00     10
47.00     9
         ..
71.00     2
59.00     2
63.00     2
0.83      2
30.50     2
70.00     2
57.00     2
0.75      2
13.00     2
10.00     2
64.00     2
40.50     2
32.50     2
45.50     2
20.50     1
24.50     1
0.67      1
14.50     1
0.92      1
74.00     1
34.50     1
80.00     1
12.00     1
36.50     1
53.00     1
55.50     1
70.50     1
66.00     1
23.50     1
0.42      1
Name: age, Length: 88, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Age = <span class="number">10</span>*(T[<span class="string">"age"</span>]//<span class="number">10</span>)</span><br><span class="line">Age = Age.astype(int)</span><br><span class="line">Age.head()</span><br><span class="line">Age.value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>20    220
30    167
10    102
40     89
0      62
50     48
60     19
70      6
80      1
Name: age, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Age.astype(str)+<span class="string">"s"</span></span><br></pre></td></tr></table></figure>
<pre><code>0      20s
1      30s
2      20s
3      30s
4      30s
6      50s
7       0s
8      20s
9      10s
10      0s
11     50s
12     20s
13     30s
14     10s
15     50s
16      0s
18     30s
20     30s
21     30s
22     10s
23     20s
24      0s
25     30s
27     10s
30     40s
33     60s
34     20s
35     40s
37     20s
38     10s
      ... 
856    40s
857    50s
858    20s
860    40s
861    20s
862    40s
864    20s
865    40s
866    20s
867    30s
869     0s
870    20s
871    40s
872    30s
873    40s
874    20s
875    10s
876    20s
877    10s
879    50s
880    20s
881    30s
882    20s
883    20s
884    20s
885    30s
886    20s
887    10s
889    20s
890    30s
Name: age, Length: 714, dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T.groupby([<span class="string">"sex"</span>, Age])[<span class="string">"survived"</span>].mean().unstack()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>age</th>
      <th>0</th>
      <th>10</th>
      <th>20</th>
      <th>30</th>
      <th>40</th>
      <th>50</th>
      <th>60</th>
      <th>70</th>
      <th>80</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.633333</td>
      <td>0.755556</td>
      <td>0.722222</td>
      <td>0.833333</td>
      <td>0.687500</td>
      <td>0.888889</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.593750</td>
      <td>0.122807</td>
      <td>0.168919</td>
      <td>0.214953</td>
      <td>0.210526</td>
      <td>0.133333</td>
      <td>0.133333</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T.age = Age</span><br><span class="line">T.pivot_table(<span class="string">"survived"</span>, index=<span class="string">"sex"</span>, columns=<span class="string">"age"</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>age</th>
      <th>0</th>
      <th>10</th>
      <th>20</th>
      <th>30</th>
      <th>40</th>
      <th>50</th>
      <th>60</th>
      <th>70</th>
      <th>80</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.633333</td>
      <td>0.755556</td>
      <td>0.722222</td>
      <td>0.833333</td>
      <td>0.687500</td>
      <td>0.888889</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.593750</td>
      <td>0.122807</td>
      <td>0.168919</td>
      <td>0.214953</td>
      <td>0.210526</td>
      <td>0.133333</td>
      <td>0.133333</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.groupby(<span class="string">"sex"</span>)[[<span class="string">"survived"</span>]].mean()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.742038</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.188908</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.groupby(<span class="string">"sex"</span>)[<span class="string">"survived"</span>].mean()</span><br></pre></td></tr></table></figure>
<pre><code>sex
female    0.742038
male      0.188908
Name: survived, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.groupby([<span class="string">"sex"</span>, <span class="string">"class"</span>])[<span class="string">"survived"</span>].aggregate(<span class="string">"mean"</span>).unstack()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>数据透视表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.pivot_table(<span class="string">"survived"</span>, index=<span class="string">"sex"</span>, columns=<span class="string">"class"</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.pivot_table(<span class="string">"survived"</span>, index=<span class="string">"sex"</span>, columns=<span class="string">"class"</span>, aggfunc=<span class="string">"mean"</span>, margins=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>All</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
      <td>0.742038</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
      <td>0.188908</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.629630</td>
      <td>0.472826</td>
      <td>0.242363</td>
      <td>0.383838</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.pivot_table(index=<span class="string">"sex"</span>, columns=<span class="string">"class"</span>, aggfunc=&#123;<span class="string">"survived"</span>: <span class="string">"sum"</span>, <span class="string">"fare"</span>: <span class="string">"mean"</span>&#125;)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">fare</th>
      <th colspan="3" halign="left">survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>106.125798</td>
      <td>21.970121</td>
      <td>16.118810</td>
      <td>91</td>
      <td>70</td>
      <td>72</td>
    </tr>
    <tr>
      <th>male</th>
      <td>67.226127</td>
      <td>19.741782</td>
      <td>12.661633</td>
      <td>45</td>
      <td>17</td>
      <td>47</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="12-7-其他"><a href="#12-7-其他" class="headerlink" title="12.7 其他"></a>12.7 其他</h2><p><strong>（1）向量化字符串操作</strong></p>
<p><strong>（2） 处理时间序列</strong></p>
<p><strong>（3） 多级索引：用于多维数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">base_data = np.array([[<span class="number">1771</span>, <span class="number">11115</span> ],</span><br><span class="line">                      [<span class="number">2154</span>, <span class="number">30320</span>],</span><br><span class="line">                      [<span class="number">2141</span>, <span class="number">14070</span>],</span><br><span class="line">                      [<span class="number">2424</span>, <span class="number">32680</span>],</span><br><span class="line">                      [<span class="number">1077</span>, <span class="number">7806</span>],</span><br><span class="line">                      [<span class="number">1303</span>, <span class="number">24222</span>],</span><br><span class="line">                      [<span class="number">798</span>, <span class="number">4789</span>],</span><br><span class="line">                      [<span class="number">981</span>, <span class="number">13468</span>]]) </span><br><span class="line">data = pd.DataFrame(base_data, index=[[<span class="string">"BeiJing"</span>,<span class="string">"BeiJing"</span>,<span class="string">"ShangHai"</span>,<span class="string">"ShangHai"</span>,<span class="string">"ShenZhen"</span>,<span class="string">"ShenZhen"</span>,<span class="string">"HangZhou"</span>,<span class="string">"HangZhou"</span>]\</span><br><span class="line">                                     , [<span class="number">2008</span>, <span class="number">2018</span>]*<span class="number">4</span>], columns=[<span class="string">"population"</span>, <span class="string">"GDP"</span>])</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>population</th>
      <th>GDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">BeiJing</th>
      <th>2008</th>
      <td>1771</td>
      <td>11115</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">ShangHai</th>
      <th>2008</th>
      <td>2141</td>
      <td>14070</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">ShenZhen</th>
      <th>2008</th>
      <td>1077</td>
      <td>7806</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">HangZhou</th>
      <th>2008</th>
      <td>798</td>
      <td>4789</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.index.names = [<span class="string">"city"</span>, <span class="string">"year"</span>]</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>population</th>
      <th>GDP</th>
    </tr>
    <tr>
      <th>city</th>
      <th>year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">BeiJing</th>
      <th>2008</th>
      <td>1771</td>
      <td>11115</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>2154</td>
      <td>30320</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">ShangHai</th>
      <th>2008</th>
      <td>2141</td>
      <td>14070</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>2424</td>
      <td>32680</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">ShenZhen</th>
      <th>2008</th>
      <td>1077</td>
      <td>7806</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>1303</td>
      <td>24222</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">HangZhou</th>
      <th>2008</th>
      <td>798</td>
      <td>4789</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>981</td>
      <td>13468</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">"GDP"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>city      year
BeiJing   2008    11115
          2018    30320
ShangHai  2008    14070
          2018    32680
ShenZhen  2008     7806
          2018    24222
HangZhou  2008     4789
          2018    13468
Name: GDP, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[<span class="string">"ShangHai"</span>, <span class="string">"GDP"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>year
2008    14070
2018    32680
Name: GDP, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[<span class="string">"ShangHai"</span>, <span class="number">2018</span>][<span class="string">"GDP"</span>]</span><br></pre></td></tr></table></figure>
<pre><code>32680
</code></pre><p><strong>（4） 高性能的Pandas：eval（）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1, df2, df3, df4 = (pd.DataFrame(np.random.random((<span class="number">10000</span>,<span class="number">100</span>))) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit (df1+df2)/(df3+df4)</span><br></pre></td></tr></table></figure>
<pre><code>10.7 ms ± 323 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</code></pre><ul>
<li>减少了复合代数式计算中间过程的内存分配</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit pd.eval(<span class="string">"(df1+df2)/(df3+df4)"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>7.69 ms ± 288 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.allclose((df1+df2)/(df3+df4), pd.eval(<span class="string">"(df1+df2)/(df3+df4)"</span>))</span><br></pre></td></tr></table></figure>
<pre><code>True
</code></pre><ul>
<li>实现列间运算</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.random((<span class="number">1000</span>, <span class="number">3</span>)), columns=list(<span class="string">"ABC"</span>))</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.444109</td>
      <td>0.403663</td>
      <td>0.865813</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.294881</td>
      <td>0.458937</td>
      <td>0.235739</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.312199</td>
      <td>0.256650</td>
      <td>0.393556</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.080160</td>
      <td>0.176736</td>
      <td>0.385579</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.830258</td>
      <td>0.352358</td>
      <td>0.186917</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res_1 = pd.eval(<span class="string">"(df.A+df.B)/(df.C-1)"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res_2 = df.eval(<span class="string">"(A+B)/(C-1)"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.allclose(res_1, res_2)</span><br></pre></td></tr></table></figure>
<pre><code>True
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"D"</span>] = pd.eval(<span class="string">"(df.A+df.B)/(df.C-1)"</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.444109</td>
      <td>0.403663</td>
      <td>0.865813</td>
      <td>-6.317854</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.294881</td>
      <td>0.458937</td>
      <td>0.235739</td>
      <td>-0.986336</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.312199</td>
      <td>0.256650</td>
      <td>0.393556</td>
      <td>-0.938006</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.080160</td>
      <td>0.176736</td>
      <td>0.385579</td>
      <td>-0.418112</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.830258</td>
      <td>0.352358</td>
      <td>0.186917</td>
      <td>-1.454484</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.eval(<span class="string">"D=(A+B)/(C-1)"</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.444109</td>
      <td>0.403663</td>
      <td>0.865813</td>
      <td>-6.317854</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.294881</td>
      <td>0.458937</td>
      <td>0.235739</td>
      <td>-0.986336</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.312199</td>
      <td>0.256650</td>
      <td>0.393556</td>
      <td>-0.938006</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.080160</td>
      <td>0.176736</td>
      <td>0.385579</td>
      <td>-0.418112</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.830258</td>
      <td>0.352358</td>
      <td>0.186917</td>
      <td>-1.454484</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>使用局部变量</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">column_mean = df.mean(axis=<span class="number">1</span>)</span><br><span class="line">res = df.eval(<span class="string">"A+@column_mean"</span>)</span><br><span class="line">res.head()</span><br></pre></td></tr></table></figure>
<pre><code>0   -0.706958
1    0.295687
2    0.318299
3    0.136251
4    0.809020
dtype: float64
</code></pre><p><strong>（4） 高性能的Pandas：query（）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.444109</td>
      <td>0.403663</td>
      <td>0.865813</td>
      <td>-6.317854</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.294881</td>
      <td>0.458937</td>
      <td>0.235739</td>
      <td>-0.986336</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.312199</td>
      <td>0.256650</td>
      <td>0.393556</td>
      <td>-0.938006</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.080160</td>
      <td>0.176736</td>
      <td>0.385579</td>
      <td>-0.418112</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.830258</td>
      <td>0.352358</td>
      <td>0.186917</td>
      <td>-1.454484</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit df[(df.A &lt; <span class="number">0.5</span>) &amp; (df.B &gt; <span class="number">0.5</span>)]</span><br></pre></td></tr></table></figure>
<pre><code>1.1 ms ± 150 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit df.query(<span class="string">"(A &lt; 0.5)&amp;(B &gt; 0.5)"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>3.46 ms ± 509 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.query(<span class="string">"(A &lt; 0.5)&amp;(B &gt; 0.5)"</span>).head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>0.125739</td>
      <td>0.557392</td>
      <td>0.556752</td>
      <td>-1.541193</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.264407</td>
      <td>0.738427</td>
      <td>0.669857</td>
      <td>-3.037572</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.427045</td>
      <td>0.719621</td>
      <td>0.732786</td>
      <td>-4.291193</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.050538</td>
      <td>0.864942</td>
      <td>0.883998</td>
      <td>-7.891950</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.310231</td>
      <td>0.558427</td>
      <td>0.627987</td>
      <td>-2.335022</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.allclose(df[(df.A &lt; <span class="number">0.5</span>) &amp; (df.B &gt; <span class="number">0.5</span>)], df.query(<span class="string">"(A &lt; 0.5)&amp;(B &gt; 0.5)"</span>))</span><br></pre></td></tr></table></figure>
<pre><code>True
</code></pre><p><strong>（5）eval（）和query（）的使用时机</strong></p>
<p>小数组时，普通方法反而更快</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.values.nbytes</span><br></pre></td></tr></table></figure>
<pre><code>32000
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.values.nbytes</span><br></pre></td></tr></table></figure>
<pre><code>8000000
</code></pre></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">rgwang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://rgwang.github.io/2020/08/15/deepshare_python%E5%9F%BA%E7%A1%8012/">https://rgwang.github.io/2020/08/15/deepshare_python%E5%9F%BA%E7%A1%8012/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://rgwang.github.io" target="_blank">rgwang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a></div><div class="post_share"><div class="social-share" data-image="/img/aerial-photography-of-green-forest-695299.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8013/"><img class="prev_cover" src="/img/action-android-device-electronics-595804.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python基础13(matplotlib库)</div></div></a></div><div class="next-post pull_right"><a href="/2020/08/15/deepshare_python%E5%9F%BA%E7%A1%8011/"><img class="next_cover" src="/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">python基础11(Numpy库)</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/08/15/deepshare_python基础10/" title="python基础10(标准库)"><img class="relatedPosts_cover" src="/img/aerial-photography-of-green-forest-695299.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-15</div><div class="relatedPosts_title">python基础10(标准库)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/17/deepshare_python基础13/" title="python基础13(matplotlib库)"><img class="relatedPosts_cover" src="/img/action-android-device-electronics-595804.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-17</div><div class="relatedPosts_title">python基础13(matplotlib库)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/15/deepshare_python基础11/" title="python基础11(Numpy库)"><img class="relatedPosts_cover" src="/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-15</div><div class="relatedPosts_title">python基础11(Numpy库)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/17/deepshare_python基础14/" title="python基础14(scikit-learn库)"><img class="relatedPosts_cover" src="/img/aerial-photography-of-green-forest-695299.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-17</div><div class="relatedPosts_title">python基础14(scikit-learn库)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/17/deepshare_python基础15/" title="python基础15(时间复杂度)"><img class="relatedPosts_cover" src="/img/aerial-photography-of-green-forest-695299.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-17</div><div class="relatedPosts_title">python基础15(时间复杂度)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/06/deepshare_python基础2/" title="python基础2(基本语法元素)"><img class="relatedPosts_cover" src="/img/action-android-device-electronics-595804.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-06</div><div class="relatedPosts_title">python基础2(基本语法元素)</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" style="background-image: url(/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By rgwang</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi,welcome to my blog!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script></body></html>