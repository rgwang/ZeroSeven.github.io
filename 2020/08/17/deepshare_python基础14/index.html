<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>python基础14(scikit-learn库) | rgwang</title><meta name="description" content="第十四章 scikit-learn 库scikit-learn 库是当今最流行的机器学习算法库之一 可用来解决分类与回归问题 本章以鸢尾花数据集为例，简单了解八大传统机器学习分类算法的sk-learn实现 欲深入了解传统机器算法的原理和公式推导，请继续学习《统计学习方法》或《西瓜书》 14.0 鸢尾花数据集【1】下载数据集 1import seaborn as sns 1iris &#x3D; sns.lo"><meta name="keywords" content="python"><meta name="author" content="rgwang"><meta name="copyright" content="rgwang"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="python基础14(scikit-learn库)"><meta name="twitter:description" content="第十四章 scikit-learn 库scikit-learn 库是当今最流行的机器学习算法库之一 可用来解决分类与回归问题 本章以鸢尾花数据集为例，简单了解八大传统机器学习分类算法的sk-learn实现 欲深入了解传统机器算法的原理和公式推导，请继续学习《统计学习方法》或《西瓜书》 14.0 鸢尾花数据集【1】下载数据集 1import seaborn as sns 1iris &#x3D; sns.lo"><meta name="twitter:image" content="https://rgwang.github.io/img/action-android-device-electronics-595804.jpg"><meta property="og:type" content="article"><meta property="og:title" content="python基础14(scikit-learn库)"><meta property="og:url" content="https://rgwang.github.io/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8014/"><meta property="og:site_name" content="rgwang"><meta property="og:description" content="第十四章 scikit-learn 库scikit-learn 库是当今最流行的机器学习算法库之一 可用来解决分类与回归问题 本章以鸢尾花数据集为例，简单了解八大传统机器学习分类算法的sk-learn实现 欲深入了解传统机器算法的原理和公式推导，请继续学习《统计学习方法》或《西瓜书》 14.0 鸢尾花数据集【1】下载数据集 1import seaborn as sns 1iris &#x3D; sns.lo"><meta property="og:image" content="https://rgwang.github.io/img/action-android-device-electronics-595804.jpg"><meta property="article:published_time" content="2020-08-17T12:02:17.546Z"><meta property="article:modified_time" content="2020-08-17T12:07:27.146Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://rgwang.github.io/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8014/"><link rel="prev" title="python基础15(时间复杂度)" href="https://rgwang.github.io/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8015/"><link rel="next" title="python基础13(matplotlib库)" href="https://rgwang.github.io/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8013/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://rgwang.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/1971a47ac42c3aad3425f91b89c64fd4.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">25</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">14</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第十四章-scikit-learn-库"><span class="toc-number">1.</span> <span class="toc-text">第十四章 scikit-learn 库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#14-0-鸢尾花数据集"><span class="toc-number">1.1.</span> <span class="toc-text">14.0 鸢尾花数据集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-1-k近邻算法"><span class="toc-number">1.2.</span> <span class="toc-text">14.1 k近邻算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-2-朴素贝叶斯算法"><span class="toc-number">1.3.</span> <span class="toc-text">14.2 朴素贝叶斯算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-3-决策树算法"><span class="toc-number">1.4.</span> <span class="toc-text">14.3 决策树算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-4-逻辑回归算法"><span class="toc-number">1.5.</span> <span class="toc-text">14.4 逻辑回归算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-5-支持向量机算法"><span class="toc-number">1.6.</span> <span class="toc-text">14.5 支持向量机算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-7-集成方法——随机森林"><span class="toc-number">1.7.</span> <span class="toc-text">14.7 集成方法——随机森林</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-7-集成方法——Adaboost"><span class="toc-number">1.8.</span> <span class="toc-text">14.7 集成方法——Adaboost</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-8-集成方法——梯度提升树GBDT"><span class="toc-number">1.9.</span> <span class="toc-text">14.8 集成方法——梯度提升树GBDT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-9-大杀器"><span class="toc-number">1.10.</span> <span class="toc-text">14.9 大杀器</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/action-android-device-electronics-595804.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">rgwang</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">python基础14(scikit-learn库)</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-08-17 20:02:17"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-08-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-08-17 20:07:27"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-08-17</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Python/">Python</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 21 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="第十四章-scikit-learn-库"><a href="#第十四章-scikit-learn-库" class="headerlink" title="第十四章 scikit-learn 库"></a>第十四章 scikit-learn 库</h1><p><strong>scikit-learn 库是当今最流行的机器学习算法库之一</strong></p>
<p><strong>可用来解决分类与回归问题</strong></p>
<p><strong>本章以鸢尾花数据集为例，简单了解八大传统机器学习分类算法的sk-learn实现</strong></p>
<p><strong>欲深入了解传统机器算法的原理和公式推导，请继续学习《统计学习方法》或《西瓜书》</strong></p>
<h2 id="14-0-鸢尾花数据集"><a href="#14-0-鸢尾花数据集" class="headerlink" title="14.0 鸢尾花数据集"></a>14.0 鸢尾花数据集</h2><p>【1】下载数据集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris = sns.load_dataset(<span class="string">"iris"</span>)</span><br></pre></td></tr></table></figure>
<p>【2】数据集的查看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(iris)</span><br></pre></td></tr></table></figure>
<pre><code>pandas.core.frame.DataFrame
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris.shape</span><br></pre></td></tr></table></figure>
<pre><code>(150, 5)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris.info()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 150 entries, 0 to 149
Data columns (total 5 columns):
sepal_length    150 non-null float64
sepal_width     150 non-null float64
petal_length    150 non-null float64
petal_width     150 non-null float64
species         150 non-null object
dtypes: float64(4), object(1)
memory usage: 5.9+ KB
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.843333</td>
      <td>3.057333</td>
      <td>3.758000</td>
      <td>1.199333</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.828066</td>
      <td>0.435866</td>
      <td>1.765298</td>
      <td>0.762238</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.300000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0.100000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.100000</td>
      <td>2.800000</td>
      <td>1.600000</td>
      <td>0.300000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.800000</td>
      <td>3.000000</td>
      <td>4.350000</td>
      <td>1.300000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.400000</td>
      <td>3.300000</td>
      <td>5.100000</td>
      <td>1.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.900000</td>
      <td>4.400000</td>
      <td>6.900000</td>
      <td>2.500000</td>
    </tr>
  </tbody>
</table>
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris.species.value_counts()</span><br></pre></td></tr></table></figure>
<pre><code>virginica     50
setosa        50
versicolor    50
Name: species, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(data=iris, hue=<span class="string">"species"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x1e2ab9dacf8&gt;
</code></pre><p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/1a25a382c3fb7f2378efc733ac1acf0b.png" alt="output_16_1"></p>
<p>【3】数据清洗</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iris_simple = iris.drop([<span class="string">"sepal_length"</span>, <span class="string">"sepal_width"</span>], axis=<span class="number">1</span>)</span><br><span class="line">iris_simple.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div>

<p>【4】标签编码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"></span><br><span class="line">encoder = LabelEncoder()</span><br><span class="line">iris_simple[<span class="string">"species"</span>] = encoder.fit_transform(iris_simple[<span class="string">"species"</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris_simple</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.7</td>
      <td>0.4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.4</td>
      <td>0.3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.5</td>
      <td>0.1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.6</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.4</td>
      <td>0.1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.1</td>
      <td>0.1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.2</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.5</td>
      <td>0.4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.3</td>
      <td>0.4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.4</td>
      <td>0.3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.7</td>
      <td>0.3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1.5</td>
      <td>0.3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.7</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.5</td>
      <td>0.4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1.0</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1.7</td>
      <td>0.5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1.9</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1.6</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1.6</td>
      <td>0.4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1.6</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>120</th>
      <td>5.7</td>
      <td>2.3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>121</th>
      <td>4.9</td>
      <td>2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>122</th>
      <td>6.7</td>
      <td>2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>123</th>
      <td>4.9</td>
      <td>1.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>124</th>
      <td>5.7</td>
      <td>2.1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>125</th>
      <td>6.0</td>
      <td>1.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>126</th>
      <td>4.8</td>
      <td>1.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>127</th>
      <td>4.9</td>
      <td>1.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>128</th>
      <td>5.6</td>
      <td>2.1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>129</th>
      <td>5.8</td>
      <td>1.6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>130</th>
      <td>6.1</td>
      <td>1.9</td>
      <td>2</td>
    </tr>
    <tr>
      <th>131</th>
      <td>6.4</td>
      <td>2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>132</th>
      <td>5.6</td>
      <td>2.2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>133</th>
      <td>5.1</td>
      <td>1.5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>134</th>
      <td>5.6</td>
      <td>1.4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>135</th>
      <td>6.1</td>
      <td>2.3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>136</th>
      <td>5.6</td>
      <td>2.4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>137</th>
      <td>5.5</td>
      <td>1.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>138</th>
      <td>4.8</td>
      <td>1.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>139</th>
      <td>5.4</td>
      <td>2.1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>140</th>
      <td>5.6</td>
      <td>2.4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>141</th>
      <td>5.1</td>
      <td>2.3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>142</th>
      <td>5.1</td>
      <td>1.9</td>
      <td>2</td>
    </tr>
    <tr>
      <th>143</th>
      <td>5.9</td>
      <td>2.3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>144</th>
      <td>5.7</td>
      <td>2.5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>145</th>
      <td>5.2</td>
      <td>2.3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>146</th>
      <td>5.0</td>
      <td>1.9</td>
      <td>2</td>
    </tr>
    <tr>
      <th>147</th>
      <td>5.2</td>
      <td>2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>148</th>
      <td>5.4</td>
      <td>2.3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.1</td>
      <td>1.8</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 3 columns</p>
</div>

<p>【5】数据集的标准化（本数据集特征比较接近，实际处理过程中未标准化）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">trans = StandardScaler()</span><br><span class="line">_iris_simple = trans.fit_transform(iris_simple[[<span class="string">"petal_length"</span>, <span class="string">"petal_width"</span>]])</span><br><span class="line"><span class="comment">#_iris_simple.describe()</span></span><br><span class="line">_iris_simple = pd.DataFrame(_iris_simple, columns = [<span class="string">"petal_length"</span>, <span class="string">"petal_width"</span>])</span><br><span class="line">_iris_simple.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.500000e+02</td>
      <td>1.500000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-8.652338e-16</td>
      <td>-4.662937e-16</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.003350e+00</td>
      <td>1.003350e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.567576e+00</td>
      <td>-1.447076e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-1.226552e+00</td>
      <td>-1.183812e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.364776e-01</td>
      <td>1.325097e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.627583e-01</td>
      <td>7.906707e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.785832e+00</td>
      <td>1.712096e+00</td>
    </tr>
  </tbody>
</table>
</div>



<p>【6】构建训练集和测试集（本课暂不考虑验证集）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">train_set, test_set = train_test_split(iris_simple, test_size=<span class="number">0.2</span>)</span><br><span class="line">test_set.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>4.9</td>
      <td>1.5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>114</th>
      <td>5.1</td>
      <td>2.4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>70</th>
      <td>4.8</td>
      <td>1.8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.7</td>
      <td>0.4</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iris_x_train = train_set[[<span class="string">"petal_length"</span>, <span class="string">"petal_width"</span>]]</span><br><span class="line">iris_x_train.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>4.2</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>109</th>
      <td>6.1</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>89</th>
      <td>4.0</td>
      <td>1.3</td>
    </tr>
    <tr>
      <th>51</th>
      <td>4.5</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>97</th>
      <td>4.3</td>
      <td>1.3</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iris_y_train = train_set[<span class="string">"species"</span>].copy()</span><br><span class="line">iris_y_train.head()</span><br></pre></td></tr></table></figure>
<pre><code>61     1
109    2
89     1
51     1
97     1
Name: species, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iris_x_test = test_set[[<span class="string">"petal_length"</span>, <span class="string">"petal_width"</span>]]</span><br><span class="line">iris_x_test.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>4.9</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>114</th>
      <td>5.1</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>70</th>
      <td>4.8</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.7</td>
      <td>0.4</td>
    </tr>
  </tbody>
</table>
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iris_y_test = test_set[<span class="string">"species"</span>].copy()</span><br><span class="line">iris_y_test.head()</span><br></pre></td></tr></table></figure>
<pre><code>52     1
10     0
114    2
70     1
5      0
Name: species, dtype: int64
</code></pre><h2 id="14-1-k近邻算法"><a href="#14-1-k近邻算法" class="headerlink" title="14.1 k近邻算法"></a>14.1 k近邻算法</h2><p>【1】基本思想</p>
<p>与待预测点最近的训练数据集中的k个邻居  </p>
<p>把k个近邻中最常见的类别预测为带预测点的类别</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = KNeighborsClassifier()</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>KNeighborsClassifier(algorithm=&#39;auto&#39;, leaf_size=30, metric=&#39;minkowski&#39;,
           metric_params=None, n_jobs=1, n_neighbors=5, p=2,
           weights=&#39;uniform&#39;)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>KNeighborsClassifier(algorithm=&#39;auto&#39;, leaf_size=30, metric=&#39;minkowski&#39;,
           metric_params=None, n_jobs=1, n_neighbors=5, p=2,
           weights=&#39;uniform&#39;)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>翻转</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">encoder.inverse_transform(res)</span><br></pre></td></tr></table></figure>
<pre><code>D:\python\Anaconda3\lib\site-packages\sklearn\preprocessing\label.py:151: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size &gt; 0` to check that an array is not empty.
  if diff:

array([&#39;versicolor&#39;, &#39;setosa&#39;, &#39;virginica&#39;, &#39;virginica&#39;, &#39;setosa&#39;,
       &#39;setosa&#39;, &#39;virginica&#39;, &#39;setosa&#39;, &#39;setosa&#39;, &#39;virginica&#39;, &#39;setosa&#39;,
       &#39;setosa&#39;, &#39;versicolor&#39;, &#39;versicolor&#39;, &#39;virginica&#39;, &#39;setosa&#39;,
       &#39;versicolor&#39;, &#39;setosa&#39;, &#39;setosa&#39;, &#39;setosa&#39;, &#39;setosa&#39;, &#39;virginica&#39;,
       &#39;virginica&#39;, &#39;versicolor&#39;, &#39;versicolor&#39;, &#39;virginica&#39;, &#39;versicolor&#39;,
       &#39;setosa&#39;, &#39;virginica&#39;, &#39;setosa&#39;], dtype=object)
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:97%
</code></pre><ul>
<li>存储数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">out = iris_x_test.copy()</span><br><span class="line">out[<span class="string">"y"</span>] = iris_y_test</span><br><span class="line">out[<span class="string">"pre"</span>] = res</span><br><span class="line">out</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>y</th>
      <th>pre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>4.9</td>
      <td>1.5</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>114</th>
      <td>5.1</td>
      <td>2.4</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>70</th>
      <td>4.8</td>
      <td>1.8</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.7</td>
      <td>0.4</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1.3</td>
      <td>0.3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>107</th>
      <td>6.3</td>
      <td>1.8</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1.4</td>
      <td>0.1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>5.5</td>
      <td>1.8</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.5</td>
      <td>0.4</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.7</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>93</th>
      <td>3.3</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>69</th>
      <td>3.9</td>
      <td>1.1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>129</th>
      <td>5.8</td>
      <td>1.6</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>4.4</td>
      <td>1.3</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1.6</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.5</td>
      <td>0.1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1.6</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>143</th>
      <td>5.9</td>
      <td>2.3</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>128</th>
      <td>5.6</td>
      <td>2.1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>74</th>
      <td>4.3</td>
      <td>1.3</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>98</th>
      <td>3.0</td>
      <td>1.1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>118</th>
      <td>6.9</td>
      <td>2.3</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>65</th>
      <td>4.4</td>
      <td>1.4</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.6</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>147</th>
      <td>5.2</td>
      <td>2.0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out.to_csv(<span class="string">"iris_predict.csv"</span>)</span><br></pre></td></tr></table></figure>
<p>【3】可视化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">draw</span><span class="params">(clf)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 网格化</span></span><br><span class="line">    M, N = <span class="number">500</span>, <span class="number">500</span></span><br><span class="line">    x1_min, x2_min = iris_simple[[<span class="string">"petal_length"</span>, <span class="string">"petal_width"</span>]].min(axis=<span class="number">0</span>)</span><br><span class="line">    x1_max, x2_max = iris_simple[[<span class="string">"petal_length"</span>, <span class="string">"petal_width"</span>]].max(axis=<span class="number">0</span>)</span><br><span class="line">    t1 = np.linspace(x1_min, x1_max, M)</span><br><span class="line">    t2 = np.linspace(x2_min, x2_max, N)</span><br><span class="line">    x1, x2 = np.meshgrid(t1, t2)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 预测</span></span><br><span class="line">    x_show = np.stack((x1.flat, x2.flat), axis=<span class="number">1</span>)</span><br><span class="line">    y_predict = clf.predict(x_show)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 配色</span></span><br><span class="line">    cm_light = mpl.colors.ListedColormap([<span class="string">"#A0FFA0"</span>, <span class="string">"#FFA0A0"</span>, <span class="string">"#A0A0FF"</span>])</span><br><span class="line">    cm_dark = mpl.colors.ListedColormap([<span class="string">"g"</span>, <span class="string">"r"</span>, <span class="string">"b"</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 绘制预测区域图</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">    plt.pcolormesh(t1, t2, y_predict.reshape(x1.shape), cmap=cm_light)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 绘制原始数据点</span></span><br><span class="line">    plt.scatter(iris_simple[<span class="string">"petal_length"</span>], iris_simple[<span class="string">"petal_width"</span>], label=<span class="literal">None</span>,</span><br><span class="line">                c=iris_simple[<span class="string">"species"</span>], cmap=cm_dark, marker=<span class="string">'o'</span>, edgecolors=<span class="string">'k'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">"petal_length"</span>)</span><br><span class="line">    plt.ylabel(<span class="string">"petal_width"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 绘制图例</span></span><br><span class="line">    color = [<span class="string">"g"</span>, <span class="string">"r"</span>, <span class="string">"b"</span>]</span><br><span class="line">    species = [<span class="string">"setosa"</span>, <span class="string">"virginica"</span>, <span class="string">"versicolor"</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        plt.scatter([], [], c=color[i], s=<span class="number">40</span>, label=species[i])    <span class="comment"># 利用空点绘制图例</span></span><br><span class="line">    plt.legend(loc=<span class="string">"best"</span>)</span><br><span class="line">    plt.title(<span class="string">'iris_classfier'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/799e3fa4bdd105bb8889120ce3b5bd6a.png" alt="output_51_0"></p>
<h2 id="14-2-朴素贝叶斯算法"><a href="#14-2-朴素贝叶斯算法" class="headerlink" title="14.2 朴素贝叶斯算法"></a>14.2 朴素贝叶斯算法</h2><p>【1】基本思想</p>
<p>当X=(x1, x2)发生的时候，哪一个yk发生的概率最大</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = GaussianNB()</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>GaussianNB(priors=None)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>GaussianNB(priors=None)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:97%
</code></pre><ul>
<li>可视化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/60bb7c1cd214a4177e4d3bda9f2af1ed.png" alt="output_66_0"></p>
<h2 id="14-3-决策树算法"><a href="#14-3-决策树算法" class="headerlink" title="14.3 决策树算法"></a>14.3 决策树算法</h2><p>【1】基本思想</p>
<p>CART算法：每次通过一个特征，将数据尽可能的分为纯净的两类，递归的分下去</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = DecisionTreeClassifier()</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 1 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:93%
</code></pre><ul>
<li>可视化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/89d38c527d0efdf1b8b7a44bb001030a.png" alt="output_81_0"></p>
<h2 id="14-4-逻辑回归算法"><a href="#14-4-逻辑回归算法" class="headerlink" title="14.4 逻辑回归算法"></a>14.4 逻辑回归算法</h2><p>【1】基本思想</p>
<p>一种解释：</p>
<p>训练：通过一个映射方式，将特征X=（x1, x2） 映射成 P(y=ck), 求使得所有概率之积最大化的映射方式里的参数</p>
<p>预测：计算p(y=ck) 取概率最大的那个类别作为预测对象的分类</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = LogisticRegression(solver=<span class="string">'saga'</span>, max_iter=<span class="number">1000</span>)</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=1000, multi_class=&#39;ovr&#39;, n_jobs=1,
          penalty=&#39;l2&#39;, random_state=None, solver=&#39;saga&#39;, tol=0.0001,
          verbose=0, warm_start=False)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=1000, multi_class=&#39;ovr&#39;, n_jobs=1,
          penalty=&#39;l2&#39;, random_state=None, solver=&#39;saga&#39;, tol=0.0001,
          verbose=0, warm_start=False)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 0 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:93%
</code></pre><ul>
<li>可视化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/c31d261220943175f7c65ad36a30ea3f.png" alt="output_96_0"></p>
<h2 id="14-5-支持向量机算法"><a href="#14-5-支持向量机算法" class="headerlink" title="14.5 支持向量机算法"></a>14.5 支持向量机算法</h2><p>【1】基本思想</p>
<p>以二分类为例，假设数据可以完全分开：</p>
<p>用一个超平面将两类数据完全分开，且最近点到平面的距离最大</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = SVC()</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape=&#39;ovr&#39;, degree=3, gamma=&#39;auto&#39;, kernel=&#39;rbf&#39;,
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape=&#39;ovr&#39;, degree=3, gamma=&#39;auto&#39;, kernel=&#39;rbf&#39;,
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:97%
</code></pre><ul>
<li>可视化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/3572362c7fac2b1ecd80fc9fd1496da7.png" alt="output_111_0"></p>
<h2 id="14-7-集成方法——随机森林"><a href="#14-7-集成方法——随机森林" class="headerlink" title="14.7 集成方法——随机森林"></a>14.7 集成方法——随机森林</h2><p>【1】基本思想</p>
<p>训练集m，有放回的随机抽取m个数据，构成一组，共抽取n组采样集</p>
<p>n组采样集训练得到n个弱分类器   弱分类器一般用决策树或神经网络</p>
<p>将n个弱分类器进行组合得到强分类器</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = RandomForestClassifier()</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=10, n_jobs=1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=10, n_jobs=1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 1 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:93%
</code></pre><ul>
<li>可视化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/696f727bf9e2081d5430c7aecfaf92d2.png" alt="output_126_0"></p>
<h2 id="14-7-集成方法——Adaboost"><a href="#14-7-集成方法——Adaboost" class="headerlink" title="14.7 集成方法——Adaboost"></a>14.7 集成方法——Adaboost</h2><p>【1】基本思想</p>
<p>训练集m，用初始数据权重训练得到第一个弱分类器，根据误差率计算弱分类器系数，更新数据的权重</p>
<p>使用新的权重训练得到第二个弱分类器，以此类推</p>
<p>根据各自系数，将所有弱分类器加权求和获得强分类器</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> AdaBoostClassifier</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = AdaBoostClassifier()</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>AdaBoostClassifier(algorithm=&#39;SAMME.R&#39;, base_estimator=None,
          learning_rate=1.0, n_estimators=50, random_state=None)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>AdaBoostClassifier(algorithm=&#39;SAMME.R&#39;, base_estimator=None,
          learning_rate=1.0, n_estimators=50, random_state=None)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 1 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:93%
</code></pre><ul>
<li>可视化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/e0b703a488b5e8cd52b0428431efd4cb.png" alt="output_141_0"></p>
<h2 id="14-8-集成方法——梯度提升树GBDT"><a href="#14-8-集成方法——梯度提升树GBDT" class="headerlink" title="14.8 集成方法——梯度提升树GBDT"></a>14.8 集成方法——梯度提升树GBDT</h2><p>【1】基本思想</p>
<p>训练集m，获得第一个弱分类器，获得残差，然后不断地拟合残差</p>
<p>所有弱分类器相加得到强分类器</p>
<p>【2】sklearn实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingClassifier</span><br></pre></td></tr></table></figure>
<ul>
<li>构建分类器对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clf = GradientBoostingClassifier()</span><br><span class="line">clf</span><br></pre></td></tr></table></figure>
<pre><code>GradientBoostingClassifier(criterion=&#39;friedman_mse&#39;, init=None,
              learning_rate=0.1, loss=&#39;deviance&#39;, max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=100,
              presort=&#39;auto&#39;, random_state=None, subsample=1.0, verbose=0,
              warm_start=False)
</code></pre><ul>
<li>训练</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clf.fit(iris_x_train, iris_y_train)</span><br></pre></td></tr></table></figure>
<pre><code>GradientBoostingClassifier(criterion=&#39;friedman_mse&#39;, init=None,
              learning_rate=0.1, loss=&#39;deviance&#39;, max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=100,
              presort=&#39;auto&#39;, random_state=None, subsample=1.0, verbose=0,
              warm_start=False)
</code></pre><ul>
<li>预测</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = clf.predict(iris_x_test)</span><br><span class="line">print(res)</span><br><span class="line">print(iris_y_test.values)</span><br></pre></td></tr></table></figure>
<pre><code>[1 0 2 2 0 0 2 0 0 2 0 0 1 1 1 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
[1 0 2 1 0 0 2 0 0 2 0 0 1 1 2 0 1 0 0 0 0 2 2 1 1 2 1 0 2 0]
</code></pre><ul>
<li>评估</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accuracy = clf.score(iris_x_test, iris_y_test)</span><br><span class="line">print(<span class="string">"预测正确率:&#123;:.0%&#125;"</span>.format(accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>预测正确率:93%
</code></pre><ul>
<li>可视化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw(clf)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/rgwang/CDN@latest/2020/08/17/967f35a44bbef8c85188f775d67f0dbe.png" alt="output_156_0"></p>
<h2 id="14-9-大杀器"><a href="#14-9-大杀器" class="headerlink" title="14.9 大杀器"></a>14.9 大杀器</h2><p>【1】xgboost</p>
<p>GBDT的损失函数只对误差部分做负梯度（一阶泰勒）展开</p>
<p>XGBoost损失函数对误差部分做二阶泰勒展开，更加准确，更快收敛</p>
<p>【2】lightgbm</p>
<p>微软：快速的，分布式的，高性能的基于决策树算法的梯度提升框架</p>
<p>速度更快</p>
<p>【3】stacking</p>
<p>堆叠或者叫模型融合</p>
<p>先建立几个简单的模型进行训练，第二级学习器会基于前级模型的预测结果进行再训练</p>
<p>【4】神经网络</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">rgwang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://rgwang.github.io/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8014/">https://rgwang.github.io/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8014/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://rgwang.github.io" target="_blank">rgwang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a></div><div class="post_share"><div class="social-share" data-image="/img/abstract-blackboard-bulb-chalk-355948.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8015/"><img class="prev_cover" src="/img/ball-ball-shaped-color-earth-269724.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python基础15(时间复杂度)</div></div></a></div><div class="next-post pull_right"><a href="/2020/08/17/deepshare_python%E5%9F%BA%E7%A1%8013/"><img class="next_cover" src="/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">python基础13(matplotlib库)</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/08/15/deepshare_python基础10/" title="python基础10(标准库)"><img class="relatedPosts_cover" src="/img/action-android-device-electronics-595804.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-15</div><div class="relatedPosts_title">python基础10(标准库)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/15/deepshare_python基础11/" title="python基础11(Numpy库)"><img class="relatedPosts_cover" src="/img/abstract-blackboard-bulb-chalk-355948.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-15</div><div class="relatedPosts_title">python基础11(Numpy库)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/17/deepshare_python基础15/" title="python基础15(时间复杂度)"><img class="relatedPosts_cover" src="/img/ball-ball-shaped-color-earth-269724.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-17</div><div class="relatedPosts_title">python基础15(时间复杂度)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/17/deepshare_python基础13/" title="python基础13(matplotlib库)"><img class="relatedPosts_cover" src="/img/volcano-erupting-at-night-under-starry-sky-4220967.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-17</div><div class="relatedPosts_title">python基础13(matplotlib库)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/06/deepshare_python基础2/" title="python基础2(基本语法元素)"><img class="relatedPosts_cover" src="/img/ball-ball-shaped-color-earth-269724.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-06</div><div class="relatedPosts_title">python基础2(基本语法元素)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/06/deepshare_python基础3/" title="python基础3(基本数据类型)"><img class="relatedPosts_cover" src="/img/landscape-photo-of-mountain-with-polar-lights-1434608.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-08-06</div><div class="relatedPosts_title">python基础3(基本数据类型)</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" style="background-image: url(/img/action-android-device-electronics-595804.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By rgwang</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi,welcome to my blog!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script></body></html>